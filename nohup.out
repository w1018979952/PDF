#改测试集224用注意力
Namespace(backbone='resnet50', batch_size=32, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=3), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=20, n_iter_per_epoch=300, num_workers=3, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 244
Epoch: [ 1/20], cls_loss: 1.6434, transfer_loss: 0.6940, total_Loss: 2.3738, test_loss 1.894694, test_acc: 21.3115
Epoch: [ 2/20], cls_loss: 1.1009, transfer_loss: 0.6846, total_Loss: 1.7994, test_loss 2.616709, test_acc: 22.1311
Epoch: [ 3/20], cls_loss: 0.6492, transfer_loss: 0.6728, total_Loss: 1.3335, test_loss 3.296153, test_acc: 20.9016
Epoch: [ 4/20], cls_loss: 0.3845, transfer_loss: 0.6604, total_Loss: 1.0553, test_loss 3.633790, test_acc: 19.2623
Epoch: [ 5/20], cls_loss: 0.2444, transfer_loss: 0.6560, total_Loss: 0.9092, test_loss 4.032415, test_acc: 22.1311
Epoch: [ 6/20], cls_loss: 0.1841, transfer_loss: 0.6643, total_Loss: 0.8563, test_loss 4.417924, test_acc: 21.3115
Epoch: [ 7/20], cls_loss: 0.1373, transfer_loss: 0.6721, total_Loss: 0.8165, test_loss 4.670673, test_acc: 25.4098
Epoch: [ 8/20], cls_loss: 0.1097, transfer_loss: 0.6745, total_Loss: 0.7905, test_loss 4.833406, test_acc: 25.0000
Epoch: [ 9/20], cls_loss: 0.0945, transfer_loss: 0.6735, total_Loss: 0.7740, test_loss 5.223851, test_acc: 25.0000
Epoch: [10/20], cls_loss: 0.0795, transfer_loss: 0.6729, total_Loss: 0.7581, test_loss 5.185314, test_acc: 24.1803
Epoch: [11/20], cls_loss: 0.0704, transfer_loss: 0.6732, total_Loss: 0.7491, test_loss 5.422319, test_acc: 22.1311
Epoch: [12/20], cls_loss: 0.0588, transfer_loss: 0.6734, total_Loss: 0.7374, test_loss 5.778780, test_acc: 22.1311
Epoch: [13/20], cls_loss: 0.0562, transfer_loss: 0.6731, total_Loss: 0.7342, test_loss 5.844993, test_acc: 22.1311
Epoch: [14/20], cls_loss: 0.0469, transfer_loss: 0.6742, total_Loss: 0.7258, test_loss 5.923619, test_acc: 21.3115
Epoch: [15/20], cls_loss: 0.0486, transfer_loss: 0.6765, total_Loss: 0.7298, test_loss 5.977651, test_acc: 23.7705
Epoch: [16/20], cls_loss: 0.0425, transfer_loss: 0.6765, total_Loss: 0.7235, test_loss 6.122389, test_acc: 22.5410
Epoch: [17/20], cls_loss: 0.0385, transfer_loss: 0.6782, total_Loss: 0.7212, test_loss 6.375198, test_acc: 21.3115
Epoch: [18/20], cls_loss: 0.0363, transfer_loss: 0.6781, total_Loss: 0.7187, test_loss 6.224805, test_acc: 23.3607
Epoch: [19/20], cls_loss: 0.0367, transfer_loss: 0.6796, total_Loss: 0.7207, test_loss 6.353127, test_acc: 24.1803
Epoch: [20/20], cls_loss: 0.0309, transfer_loss: 0.6795, total_Loss: 0.7145, test_loss 6.420437, test_acc: 22.5410
Transfer result: 25.4098
#改测试集没用注意力
Namespace(backbone='resnet50', batch_size=32, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=3), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=20, n_iter_per_epoch=300, num_workers=3, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 244
Epoch: [ 1/20], cls_loss: 1.6259, transfer_loss: 0.6955, total_Loss: 2.3213, test_loss 1.953288, test_acc: 19.2623
Epoch: [ 2/20], cls_loss: 1.0706, transfer_loss: 0.6866, total_Loss: 1.7572, test_loss 2.691400, test_acc: 22.1311
Epoch: [ 3/20], cls_loss: 0.6260, transfer_loss: 0.6746, total_Loss: 1.3006, test_loss 3.367289, test_acc: 22.1311
Epoch: [ 4/20], cls_loss: 0.3682, transfer_loss: 0.6595, total_Loss: 1.0277, test_loss 3.741415, test_acc: 23.3607
Epoch: [ 5/20], cls_loss: 0.2396, transfer_loss: 0.6480, total_Loss: 0.8876, test_loss 4.398359, test_acc: 22.9508
Epoch: [ 6/20], cls_loss: 0.1724, transfer_loss: 0.6577, total_Loss: 0.8300, test_loss 4.603429, test_acc: 22.1311
Epoch: [ 7/20], cls_loss: 0.1331, transfer_loss: 0.6676, total_Loss: 0.8007, test_loss 4.905068, test_acc: 23.3607
Epoch: [ 8/20], cls_loss: 0.1048, transfer_loss: 0.6734, total_Loss: 0.7781, test_loss 5.260923, test_acc: 23.3607
Epoch: [ 9/20], cls_loss: 0.0935, transfer_loss: 0.6745, total_Loss: 0.7680, test_loss 5.671408, test_acc: 21.7213
Epoch: [10/20], cls_loss: 0.0780, transfer_loss: 0.6742, total_Loss: 0.7522, test_loss 5.659892, test_acc: 21.7213
Epoch: [11/20], cls_loss: 0.0677, transfer_loss: 0.6755, total_Loss: 0.7432, test_loss 5.819239, test_acc: 22.5410
Epoch: [12/20], cls_loss: 0.0599, transfer_loss: 0.6769, total_Loss: 0.7368, test_loss 6.077663, test_acc: 23.7705
Epoch: [13/20], cls_loss: 0.0537, transfer_loss: 0.6787, total_Loss: 0.7324, test_loss 6.152410, test_acc: 22.9508
Epoch: [14/20], cls_loss: 0.0450, transfer_loss: 0.6786, total_Loss: 0.7236, test_loss 6.353247, test_acc: 21.3115
Epoch: [15/20], cls_loss: 0.0453, transfer_loss: 0.6802, total_Loss: 0.7256, test_loss 6.363886, test_acc: 24.1803
Epoch: [16/20], cls_loss: 0.0401, transfer_loss: 0.6799, total_Loss: 0.7201, test_loss 6.391264, test_acc: 22.5410
Epoch: [17/20], cls_loss: 0.0355, transfer_loss: 0.6808, total_Loss: 0.7163, test_loss 6.644441, test_acc: 22.1311
Epoch: [18/20], cls_loss: 0.0363, transfer_loss: 0.6813, total_Loss: 0.7176, test_loss 6.479781, test_acc: 22.5410
Epoch: [19/20], cls_loss: 0.0334, transfer_loss: 0.6823, total_Loss: 0.7157, test_loss 6.575847, test_acc: 20.9016
Epoch: [20/20], cls_loss: 0.0295, transfer_loss: 0.6828, total_Loss: 0.7123, test_loss 6.653957, test_acc: 23.3607
Transfer result: 24.1803
#用32*1*7*7
Namespace(backbone='resnet50', batch_size=32, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=3), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=20, n_iter_per_epoch=300, num_workers=3, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 11613
Epoch: [ 1/20], cls_loss: 1.6263, transfer_loss: 0.6924, total_Loss: 2.3188, test_loss 2.007715, test_acc: 20.5115
Epoch: [ 2/20], cls_loss: 1.0597, transfer_loss: 0.6906, total_Loss: 1.7503, test_loss 2.760205, test_acc: 19.7709
Epoch: [ 3/20], cls_loss: 0.6107, transfer_loss: 0.6877, total_Loss: 1.2984, test_loss 3.649352, test_acc: 20.3651
Epoch: [ 4/20], cls_loss: 0.3548, transfer_loss: 0.6817, total_Loss: 1.0365, test_loss 4.189440, test_acc: 18.2812
Epoch: [ 5/20], cls_loss: 0.2327, transfer_loss: 0.6643, total_Loss: 0.8970, test_loss 4.598389, test_acc: 19.2285
Epoch: [ 6/20], cls_loss: 0.1660, transfer_loss: 0.5872, total_Loss: 0.7532, test_loss 5.404973, test_acc: 20.2015
Epoch: [ 7/20], cls_loss: 0.1274, transfer_loss: 0.3572, total_Loss: 0.4846, test_loss 5.550339, test_acc: 20.9076
Epoch: [ 8/20], cls_loss: 0.1070, transfer_loss: 0.2590, total_Loss: 0.3660, test_loss 5.867250, test_acc: 20.7095
Epoch: [ 9/20], cls_loss: 0.0900, transfer_loss: 0.2189, total_Loss: 0.3088, test_loss 5.456510, test_acc: 20.8129
Epoch: [10/20], cls_loss: 0.0777, transfer_loss: 0.2024, total_Loss: 0.2801, test_loss 5.968680, test_acc: 19.3232
Epoch: [11/20], cls_loss: 0.0680, transfer_loss: 0.1993, total_Loss: 0.2673, test_loss 6.141251, test_acc: 20.1240
Epoch: [12/20], cls_loss: 0.0599, transfer_loss: 0.2043, total_Loss: 0.2642, test_loss 6.160752, test_acc: 19.0562
Epoch: [13/20], cls_loss: 0.0571, transfer_loss: 0.2106, total_Loss: 0.2678, test_loss 6.185631, test_acc: 20.0034
Epoch: [14/20], cls_loss: 0.0560, transfer_loss: 0.2293, total_Loss: 0.2853, test_loss 6.005909, test_acc: 21.5707
Epoch: [15/20], cls_loss: 0.0486, transfer_loss: 0.2441, total_Loss: 0.2927, test_loss 6.070627, test_acc: 20.3909
Epoch: [16/20], cls_loss: 0.0499, transfer_loss: 0.2580, total_Loss: 0.3079, test_loss 5.927961, test_acc: 22.3543
Epoch: [17/20], cls_loss: 0.0492, transfer_loss: 0.2722, total_Loss: 0.3215, test_loss 6.155661, test_acc: 20.2446
Epoch: [18/20], cls_loss: 0.0455, transfer_loss: 0.2848, total_Loss: 0.3303, test_loss 6.123231, test_acc: 21.3209
Epoch: [19/20], cls_loss: 0.0454, transfer_loss: 0.2998, total_Loss: 0.3451, test_loss 6.140036, test_acc: 20.7268
Epoch: [20/20], cls_loss: 0.0451, transfer_loss: 0.3126, total_Loss: 0.3577, test_loss 6.091671, test_acc: 21.9668
Transfer result: 22.3543
# 加注意力后
Namespace(backbone='resnet50', batch_size=32, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=2), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=20, n_iter_per_epoch=300, num_workers=3, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 11613
Epoch: [ 1/20], cls_loss: 1.6485, transfer_loss: 0.6922, total_Loss: 2.3827, test_loss 1.979350, test_acc: 21.6740
Epoch: [ 2/20], cls_loss: 1.1011, transfer_loss: 0.6899, total_Loss: 1.8047, test_loss 2.620395, test_acc: 21.5965
Epoch: [ 3/20], cls_loss: 0.6533, transfer_loss: 0.6860, total_Loss: 1.3501, test_loss 3.545114, test_acc: 21.6912
Epoch: [ 4/20], cls_loss: 0.3840, transfer_loss: 0.6761, total_Loss: 1.0695, test_loss 4.202634, test_acc: 20.9162
Epoch: [ 5/20], cls_loss: 0.2503, transfer_loss: 0.6356, total_Loss: 0.8943, test_loss 4.687064, test_acc: 21.3295
Epoch: [ 6/20], cls_loss: 0.1820, transfer_loss: 0.4361, total_Loss: 0.6261, test_loss 5.474257, test_acc: 22.0184
Epoch: [ 7/20], cls_loss: 0.1392, transfer_loss: 0.2435, total_Loss: 0.3903, test_loss 5.636817, test_acc: 20.2876
Epoch: [ 8/20], cls_loss: 0.1169, transfer_loss: 0.2213, total_Loss: 0.3450, test_loss 5.637705, test_acc: 19.9087
Epoch: [ 9/20], cls_loss: 0.0961, transfer_loss: 0.2064, total_Loss: 0.3087, test_loss 5.686624, test_acc: 20.0379
Epoch: [10/20], cls_loss: 0.0844, transfer_loss: 0.1942, total_Loss: 0.2845, test_loss 6.118566, test_acc: 21.0540
Epoch: [11/20], cls_loss: 0.0735, transfer_loss: 0.1933, total_Loss: 0.2720, test_loss 5.720973, test_acc: 21.2004
Epoch: [12/20], cls_loss: 0.0656, transfer_loss: 0.1981, total_Loss: 0.2686, test_loss 5.872836, test_acc: 21.8548
Epoch: [13/20], cls_loss: 0.0611, transfer_loss: 0.2088, total_Loss: 0.2747, test_loss 5.963572, test_acc: 21.2176
Epoch: [14/20], cls_loss: 0.0574, transfer_loss: 0.2203, total_Loss: 0.2825, test_loss 5.797853, test_acc: 21.7257
Epoch: [15/20], cls_loss: 0.0489, transfer_loss: 0.2340, total_Loss: 0.2875, test_loss 6.036048, test_acc: 20.9507
Epoch: [16/20], cls_loss: 0.0498, transfer_loss: 0.2562, total_Loss: 0.3105, test_loss 5.814505, test_acc: 22.8709
Epoch: [17/20], cls_loss: 0.0513, transfer_loss: 0.2676, total_Loss: 0.3234, test_loss 6.046988, test_acc: 21.3468
Epoch: [18/20], cls_loss: 0.0459, transfer_loss: 0.2885, total_Loss: 0.3390, test_loss 6.137653, test_acc: 20.2962
Epoch: [19/20], cls_loss: 0.0463, transfer_loss: 0.3038, total_Loss: 0.3547, test_loss 6.121165, test_acc: 19.6590
Epoch: [20/20], cls_loss: 0.0458, transfer_loss: 0.3186, total_Loss: 0.3689, test_loss 6.006547, test_acc: 21.3382
Transfer result: 22.8709
Namespace(backbone='resnet50', batch_size=32, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=5), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=20, n_iter_per_epoch=300, num_workers=3, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 11613
Epoch: [ 1/20], cls_loss: 1.6480, transfer_loss: 0.0693, total_Loss: 1.7594, test_loss 1.980782, test_acc: 21.3640
Epoch: [ 2/20], cls_loss: 1.1004, transfer_loss: 0.0693, total_Loss: 1.1833, test_loss 2.610760, test_acc: 21.3382
Epoch: [ 3/20], cls_loss: 0.6530, transfer_loss: 0.0693, total_Loss: 0.7332, test_loss 3.578098, test_acc: 20.5632
Epoch: [ 4/20], cls_loss: 0.3842, transfer_loss: 0.0693, total_Loss: 0.4628, test_loss 4.242354, test_acc: 20.1240
Epoch: [ 5/20], cls_loss: 0.2499, transfer_loss: 0.0692, total_Loss: 0.3273, test_loss 4.730971, test_acc: 19.2371
Epoch: [ 6/20], cls_loss: 0.1808, transfer_loss: 0.0692, total_Loss: 0.2573, test_loss 5.334626, test_acc: 19.9432
Epoch: [ 7/20], cls_loss: 0.1339, transfer_loss: 0.0692, total_Loss: 0.2095, test_loss 5.561661, test_acc: 19.8312
Epoch: [ 8/20], cls_loss: 0.1076, transfer_loss: 0.0692, total_Loss: 0.1826, test_loss 5.843574, test_acc: 19.0218
Epoch: [ 9/20], cls_loss: 0.0882, transfer_loss: 0.0692, total_Loss: 0.1628, test_loss 5.926233, test_acc: 19.3404
Epoch: [10/20], cls_loss: 0.0771, transfer_loss: 0.0692, total_Loss: 0.1514, test_loss 6.261776, test_acc: 18.7032
Epoch: [11/20], cls_loss: 0.0626, transfer_loss: 0.0692, total_Loss: 0.1364, test_loss 6.210390, test_acc: 19.4179
Epoch: [12/20], cls_loss: 0.0552, transfer_loss: 0.0692, total_Loss: 0.1287, test_loss 6.233672, test_acc: 19.1079
Epoch: [13/20], cls_loss: 0.0510, transfer_loss: 0.0692, total_Loss: 0.1242, test_loss 6.362470, test_acc: 19.6676
Epoch: [14/20], cls_loss: 0.0457, transfer_loss: 0.0692, total_Loss: 0.1189, test_loss 6.333115, test_acc: 18.7721
Epoch: [15/20], cls_loss: 0.0389, transfer_loss: 0.0692, total_Loss: 0.1119, test_loss 6.586142, test_acc: 18.7807
Epoch: [16/20], cls_loss: 0.0369, transfer_loss: 0.0692, total_Loss: 0.1098, test_loss 6.548046, test_acc: 19.5815
Epoch: [17/20], cls_loss: 0.0377, transfer_loss: 0.0692, total_Loss: 0.1104, test_loss 6.652362, test_acc: 18.9357
Epoch: [18/20], cls_loss: 0.0324, transfer_loss: 0.0692, total_Loss: 0.1049, test_loss 6.921934, test_acc: 19.0390
Epoch: [19/20], cls_loss: 0.0305, transfer_loss: 0.0692, total_Loss: 0.1030, test_loss 6.873023, test_acc: 19.0046
Epoch: [20/20], cls_loss: 0.0289, transfer_loss: 0.0691, total_Loss: 0.1013, test_loss 6.804108, test_acc: 18.8840
Transfer result: 21.3640  #0.05
Namespace(backbone='resnet50', batch_size=32, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=5), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=20, n_iter_per_epoch=300, num_workers=3, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 11613
Epoch: [ 1/20], cls_loss: 1.6476, transfer_loss: 1.0375, total_Loss: 2.7271, test_loss 1.981724, test_acc: 21.1315
Epoch: [ 2/20], cls_loss: 1.1000, transfer_loss: 1.0290, total_Loss: 2.1427, test_loss 2.615778, test_acc: 21.1401
Epoch: [ 3/20], cls_loss: 0.6534, transfer_loss: 0.9622, total_Loss: 1.6266, test_loss 3.682370, test_acc: 21.8548
Epoch: [ 4/20], cls_loss: 0.3839, transfer_loss: 0.3762, total_Loss: 0.7703, test_loss 4.227145, test_acc: 22.3284
Epoch: [ 5/20], cls_loss: 0.2549, transfer_loss: 0.1950, total_Loss: 0.4591, test_loss 4.693265, test_acc: 20.7009
Epoch: [ 6/20], cls_loss: 0.1905, transfer_loss: 0.2432, total_Loss: 0.4420, test_loss 4.900258, test_acc: 20.0465
Epoch: [ 7/20], cls_loss: 0.1437, transfer_loss: 0.2809, total_Loss: 0.4322, test_loss 5.456163, test_acc: 20.4254
Epoch: [ 8/20], cls_loss: 0.1231, transfer_loss: 0.3314, total_Loss: 0.4618, test_loss 5.359348, test_acc: 21.4845
Epoch: [ 9/20], cls_loss: 0.1070, transfer_loss: 0.3946, total_Loss: 0.5084, test_loss 5.357834, test_acc: 20.5546
Epoch: [10/20], cls_loss: 0.1009, transfer_loss: 0.4608, total_Loss: 0.5688, test_loss 5.571366, test_acc: 19.9948
Epoch: [11/20], cls_loss: 0.0924, transfer_loss: 0.5054, total_Loss: 0.6044, test_loss 5.458911, test_acc: 20.7009
Epoch: [12/20], cls_loss: 0.0863, transfer_loss: 0.5440, total_Loss: 0.6365, test_loss 5.297114, test_acc: 22.6040
Epoch: [13/20], cls_loss: 0.0831, transfer_loss: 0.5756, total_Loss: 0.6652, test_loss 5.640479, test_acc: 20.8904
Epoch: [14/20], cls_loss: 0.0765, transfer_loss: 0.6100, total_Loss: 0.6930, test_loss 5.694491, test_acc: 22.1131
Epoch: [15/20], cls_loss: 0.0693, transfer_loss: 0.6442, total_Loss: 0.7200, test_loss 5.762549, test_acc: 20.4168
Epoch: [16/20], cls_loss: 0.0690, transfer_loss: 0.6692, total_Loss: 0.7442, test_loss 5.523613, test_acc: 23.0862
Epoch: [17/20], cls_loss: 0.0734, transfer_loss: 0.6955, total_Loss: 0.7749, test_loss 5.600677, test_acc: 21.0109
Epoch: [18/20], cls_loss: 0.0652, transfer_loss: 0.7123, total_Loss: 0.7830, test_loss 5.717080, test_acc: 21.6826
Epoch: [19/20], cls_loss: 0.0636, transfer_loss: 0.7344, total_Loss: 0.8035, test_loss 5.740948, test_acc: 22.0615
Epoch: [20/20], cls_loss: 0.0610, transfer_loss: 0.7520, total_Loss: 0.8183, test_loss 5.694446, test_acc: 20.4771
Transfer result: 23.0862  # 0.75(比0.5效果好) + attention

Namespace(backbone='resnet50', batch_size=32, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=4), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=20, n_iter_per_epoch=300, num_workers=3, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 11613
Epoch: [ 1/20], cls_loss: 1.6434, transfer_loss: 0.6940, total_Loss: 2.3738, test_loss 1.886952, test_acc: 21.4759
Epoch: [ 2/20], cls_loss: 1.1009, transfer_loss: 0.6846, total_Loss: 1.7994, test_loss 2.641378, test_acc: 20.2015
Epoch: [ 3/20], cls_loss: 0.6492, transfer_loss: 0.6728, total_Loss: 1.3335, test_loss 3.323474, test_acc: 18.7807
Epoch: [ 4/20], cls_loss: 0.3845, transfer_loss: 0.6604, total_Loss: 1.0553, test_loss 3.713109, test_acc: 19.6332
Epoch: [ 5/20], cls_loss: 0.2444, transfer_loss: 0.6560, total_Loss: 0.9092, test_loss 4.165852, test_acc: 20.4340
Epoch: [ 6/20], cls_loss: 0.1841, transfer_loss: 0.6643, total_Loss: 0.8563, test_loss 4.598763, test_acc: 21.2348
Epoch: [ 7/20], cls_loss: 0.1373, transfer_loss: 0.6721, total_Loss: 0.8165, test_loss 4.776768, test_acc: 21.3812
Epoch: [ 8/20], cls_loss: 0.1097, transfer_loss: 0.6745, total_Loss: 0.7905, test_loss 4.973077, test_acc: 21.4243
Epoch: [ 9/20], cls_loss: 0.0945, transfer_loss: 0.6735, total_Loss: 0.7740, test_loss 5.406152, test_acc: 20.2876
Epoch: [10/20], cls_loss: 0.0795, transfer_loss: 0.6729, total_Loss: 0.7581, test_loss 5.440273, test_acc: 20.6837
Epoch: [11/20], cls_loss: 0.0704, transfer_loss: 0.6732, total_Loss: 0.7491, test_loss 5.708019, test_acc: 20.2446
Epoch: [12/20], cls_loss: 0.0588, transfer_loss: 0.6734, total_Loss: 0.7374, test_loss 6.130529, test_acc: 20.0723
Epoch: [13/20], cls_loss: 0.0562, transfer_loss: 0.6731, total_Loss: 0.7342, test_loss 6.198064, test_acc: 19.8140
Epoch: [14/20], cls_loss: 0.0469, transfer_loss: 0.6742, total_Loss: 0.7258, test_loss 6.334509, test_acc: 19.4696
Epoch: [15/20], cls_loss: 0.0486, transfer_loss: 0.6765, total_Loss: 0.7298, test_loss 6.403756, test_acc: 20.2704
Epoch: [16/20], cls_loss: 0.0425, transfer_loss: 0.6765, total_Loss: 0.7235, test_loss 6.540392, test_acc: 19.9173
Epoch: [17/20], cls_loss: 0.0385, transfer_loss: 0.6782, total_Loss: 0.7212, test_loss 6.867478, test_acc: 19.0993
Epoch: [18/20], cls_loss: 0.0363, transfer_loss: 0.6781, total_Loss: 0.7187, test_loss 6.710051, test_acc: 20.1240
Epoch: [19/20], cls_loss: 0.0367, transfer_loss: 0.6796, total_Loss: 0.7207, test_loss 6.885129, test_acc: 19.8398
Epoch: [20/20], cls_loss: 0.0309, transfer_loss: 0.6795, total_Loss: 0.7145, test_loss 6.921594, test_acc: 19.5557
Transfer result: 21.4759

Namespace(backbone='resnet50', batch_size=32, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=2), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=20, n_iter_per_epoch=300, num_workers=3, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 11613
Epoch: [ 1/20], cls_loss: 1.6599, transfer_loss: 1.3817, total_Loss: 3.0828, test_loss 1.917041, test_acc: 20.3737
Epoch: [ 2/20], cls_loss: 1.1231, transfer_loss: 1.3314, total_Loss: 2.4682, test_loss 2.763064, test_acc: 18.1607
Epoch: [ 3/20], cls_loss: 0.6780, transfer_loss: 0.4300, total_Loss: 1.1194, test_loss 3.471856, test_acc: 22.5523
Epoch: [ 4/20], cls_loss: 0.4043, transfer_loss: 0.1693, total_Loss: 0.5841, test_loss 4.145313, test_acc: 21.1143
Epoch: [ 5/20], cls_loss: 0.2713, transfer_loss: 0.2461, total_Loss: 0.5272, test_loss 4.605203, test_acc: 19.1337
Epoch: [ 6/20], cls_loss: 0.1892, transfer_loss: 0.3397, total_Loss: 0.5378, test_loss 4.822659, test_acc: 20.0982
Epoch: [ 7/20], cls_loss: 0.1671, transfer_loss: 0.4709, total_Loss: 0.6468, test_loss 4.711705, test_acc: 20.5976
Epoch: [ 8/20], cls_loss: 0.1439, transfer_loss: 0.6228, total_Loss: 0.7758, test_loss 5.009333, test_acc: 20.5976
Epoch: [ 9/20], cls_loss: 0.1315, transfer_loss: 0.7333, total_Loss: 0.8733, test_loss 4.798902, test_acc: 21.6740
Epoch: [10/20], cls_loss: 0.1197, transfer_loss: 0.8173, total_Loss: 0.9446, test_loss 4.857971, test_acc: 23.7923
Epoch: [11/20], cls_loss: 0.1127, transfer_loss: 0.8940, total_Loss: 1.0139, test_loss 4.821430, test_acc: 23.6890
Epoch: [12/20], cls_loss: 0.1067, transfer_loss: 0.9433, total_Loss: 1.0574, test_loss 5.266043, test_acc: 21.6051
Epoch: [13/20], cls_loss: 0.0953, transfer_loss: 0.9838, total_Loss: 1.0863, test_loss 5.290465, test_acc: 22.6212
Epoch: [14/20], cls_loss: 0.0943, transfer_loss: 1.0263, total_Loss: 1.1271, test_loss 5.300794, test_acc: 22.6126
Epoch: [15/20], cls_loss: 0.0910, transfer_loss: 1.0572, total_Loss: 1.1544, test_loss 5.287511, test_acc: 21.8204
Epoch: [16/20], cls_loss: 0.0824, transfer_loss: 1.0823, total_Loss: 1.1708, test_loss 5.566476, test_acc: 20.6751
Epoch: [17/20], cls_loss: 0.0767, transfer_loss: 1.1119, total_Loss: 1.1941, test_loss 5.502190, test_acc: 22.7159
Epoch: [18/20], cls_loss: 0.0752, transfer_loss: 1.1326, total_Loss: 1.2135, test_loss 5.478622, test_acc: 22.3370
Epoch: [19/20], cls_loss: 0.0692, transfer_loss: 1.1474, total_Loss: 1.2219, test_loss 5.688758, test_acc: 22.3715
Epoch: [20/20], cls_loss: 0.0710, transfer_loss: 1.1641, total_Loss: 1.2403, test_loss 5.741888, test_acc: 21.5190
Transfer result: 23.7923

Namespace(backbone='resnet50', batch_size=32, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=2), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=20, n_iter_per_epoch=300, num_workers=3, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 11613
Epoch: [ 1/20], cls_loss: 1.6605, transfer_loss: 2.6754, total_Loss: 4.3772, test_loss 1.920376, test_acc: 20.3565
Epoch: [ 2/20], cls_loss: 1.1255, transfer_loss: 0.2999, total_Loss: 1.4399, test_loss 2.765199, test_acc: 20.4340
Epoch: [ 3/20], cls_loss: 0.6786, transfer_loss: 0.2237, total_Loss: 0.9141, test_loss 3.788106, test_acc: 19.4351
Epoch: [ 4/20], cls_loss: 0.4162, transfer_loss: 0.5137, total_Loss: 0.9415, test_loss 3.917915, test_acc: 22.4145
Epoch: [ 5/20], cls_loss: 0.3052, transfer_loss: 1.0832, total_Loss: 1.4012, test_loss 4.059941, test_acc: 20.0121
Epoch: [ 6/20], cls_loss: 0.2540, transfer_loss: 1.6798, total_Loss: 1.9464, test_loss 4.697004, test_acc: 21.7084
Epoch: [ 7/20], cls_loss: 0.2480, transfer_loss: 2.0683, total_Loss: 2.3284, test_loss 4.544737, test_acc: 18.6687
Epoch: [ 8/20], cls_loss: 0.2115, transfer_loss: 2.2649, total_Loss: 2.4871, test_loss 5.046345, test_acc: 19.1251
Epoch: [ 9/20], cls_loss: 0.1743, transfer_loss: 2.3711, total_Loss: 2.5546, test_loss 4.865651, test_acc: 18.3587
Epoch: [10/20], cls_loss: 0.1593, transfer_loss: 2.4301, total_Loss: 2.5972, test_loss 5.311093, test_acc: 18.8323
Epoch: [11/20], cls_loss: 0.1396, transfer_loss: 2.4693, total_Loss: 2.6159, test_loss 5.365299, test_acc: 18.2554
Epoch: [12/20], cls_loss: 0.1253, transfer_loss: 2.5154, total_Loss: 2.6477, test_loss 5.680596, test_acc: 18.6687
Epoch: [13/20], cls_loss: 0.1078, transfer_loss: 2.5429, total_Loss: 2.6571, test_loss 5.381243, test_acc: 19.8743
Epoch: [14/20], cls_loss: 0.1007, transfer_loss: 2.5604, total_Loss: 2.6669, test_loss 5.631925, test_acc: 19.4696
Epoch: [15/20], cls_loss: 0.0971, transfer_loss: 2.5792, total_Loss: 2.6822, test_loss 6.002333, test_acc: 20.5373
Epoch: [16/20], cls_loss: 0.0840, transfer_loss: 2.5927, total_Loss: 2.6824, test_loss 6.106019, test_acc: 20.2015
Epoch: [17/20], cls_loss: 0.0779, transfer_loss: 2.6054, total_Loss: 2.6885, test_loss 6.277817, test_acc: 19.9001
Epoch: [18/20], cls_loss: 0.0771, transfer_loss: 2.6177, total_Loss: 2.6998, test_loss 5.992130, test_acc: 20.3651
Epoch: [19/20], cls_loss: 0.0648, transfer_loss: 2.6206, total_Loss: 2.6898, test_loss 6.319095, test_acc: 21.9409
Epoch: [20/20], cls_loss: 0.0636, transfer_loss: 2.6338, total_Loss: 2.7021, test_loss 6.465479, test_acc: 20.3823
Transfer result: 22.4145
Namespace(backbone='resnet50', batch_size=32, beta=0, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=5), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=20, n_iter_per_epoch=300, nav_t=1, num_workers=3, s_par=0.5, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 11613
Epoch: [ 1/20], cls_loss: 1.7080, transfer_loss: 1.3817, transfer_loss: 0.7521, total_Loss: 3.8824, test_loss 1.892439, test_acc: 19.1337
Epoch: [ 2/20], cls_loss: 1.2070, transfer_loss: 1.3390, transfer_loss: 0.6173, total_Loss: 3.1770, test_loss 3.274720, test_acc: 19.5471
Epoch: [ 3/20], cls_loss: 0.7630, transfer_loss: 0.4500, transfer_loss: 0.5093, total_Loss: 1.7333, test_loss 4.777697, test_acc: 21.4243
Epoch: [ 4/20], cls_loss: 0.4689, transfer_loss: 0.1786, transfer_loss: 0.4236, total_Loss: 1.0813, test_loss 5.496032, test_acc: 20.4426
Epoch: [ 5/20], cls_loss: 0.3087, transfer_loss: 0.2289, transfer_loss: 0.3749, total_Loss: 0.9223, test_loss 5.707896, test_acc: 19.7365
Epoch: [ 6/20], cls_loss: 0.2157, transfer_loss: 0.3146, transfer_loss: 0.3544, total_Loss: 0.8941, test_loss 6.233678, test_acc: 20.5804
Epoch: [ 7/20], cls_loss: 0.1795, transfer_loss: 0.4141, transfer_loss: 0.3451, total_Loss: 0.9482, test_loss 5.853933, test_acc: 21.0970
Epoch: [ 8/20], cls_loss: 0.1517, transfer_loss: 0.5604, transfer_loss: 0.3411, total_Loss: 1.0631, test_loss 5.384865, test_acc: 20.8990
Epoch: [ 9/20], cls_loss: 0.1294, transfer_loss: 0.6289, transfer_loss: 0.3364, total_Loss: 1.1040, test_loss 5.447241, test_acc: 20.5201
Epoch: [10/20], cls_loss: 0.1142, transfer_loss: 0.7154, transfer_loss: 0.3319, total_Loss: 1.1698, test_loss 5.596082, test_acc: 20.3651
Epoch: [11/20], cls_loss: 0.1116, transfer_loss: 0.8146, transfer_loss: 0.3300, total_Loss: 1.2649, test_loss 5.485569, test_acc: 20.0637
Epoch: [12/20], cls_loss: 0.1031, transfer_loss: 0.8701, transfer_loss: 0.3264, total_Loss: 1.3078, test_loss 5.362765, test_acc: 21.4587
Epoch: [13/20], cls_loss: 0.0989, transfer_loss: 0.9266, transfer_loss: 0.3239, total_Loss: 1.3575, test_loss 5.218898, test_acc: 22.1734
Epoch: [14/20], cls_loss: 0.0933, transfer_loss: 0.9700, transfer_loss: 0.3213, total_Loss: 1.3917, test_loss 5.562060, test_acc: 22.7418
Epoch: [15/20], cls_loss: 0.0916, transfer_loss: 1.0083, transfer_loss: 0.3191, total_Loss: 1.4262, test_loss 5.166038, test_acc: 22.1820
Epoch: [16/20], cls_loss: 0.0833, transfer_loss: 1.0396, transfer_loss: 0.3173, total_Loss: 1.4473, test_loss 5.392136, test_acc: 22.0184
Epoch: [17/20], cls_loss: 0.0780, transfer_loss: 1.0708, transfer_loss: 0.3156, total_Loss: 1.4707, test_loss 5.169880, test_acc: 21.8548
Epoch: [18/20], cls_loss: 0.0779, transfer_loss: 1.1027, transfer_loss: 0.3151, total_Loss: 1.5020, test_loss 5.271166, test_acc: 22.7934
Epoch: [19/20], cls_loss: 0.0727, transfer_loss: 1.1202, transfer_loss: 0.3121, total_Loss: 1.5112, test_loss 5.422887, test_acc: 20.6923
Epoch: [20/20], cls_loss: 0.0701, transfer_loss: 1.1396, transfer_loss: 0.3110, total_Loss: 1.5262, test_loss 4.947456, test_acc: 24.3520
Transfer result: 24.3520
Namespace(backbone='resnet50', batch_size=32, beta=0, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/USTC_NVIE/', device=device(type='cuda', index=1), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=40, n_iter_per_epoch=300, nav_t=1, num_workers=3, s_par=0.5, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 11613
Epoch: [ 1/40], cls_loss: 1.7074, transfer_loss: 1.3817, transfer_loss: 0.7520, total_Loss: 3.8818, test_loss 1.897070, test_acc: 19.2457
Epoch: [ 2/40], cls_loss: 1.2059, transfer_loss: 1.3377, transfer_loss: 0.6173, total_Loss: 3.1747, test_loss 3.296895, test_acc: 19.3662
Epoch: [ 3/40], cls_loss: 0.7602, transfer_loss: 0.3934, transfer_loss: 0.5091, total_Loss: 1.6736, test_loss 4.919271, test_acc: 19.9690
Epoch: [ 4/40], cls_loss: 0.4630, transfer_loss: 0.0621, transfer_loss: 0.4218, total_Loss: 0.9565, test_loss 5.871214, test_acc: 20.3307
Epoch: [ 5/40], cls_loss: 0.3012, transfer_loss: 0.0425, transfer_loss: 0.3679, total_Loss: 0.7202, test_loss 6.491538, test_acc: 19.7107
Epoch: [ 6/40], cls_loss: 0.2038, transfer_loss: 0.0404, transfer_loss: 0.3432, total_Loss: 0.5950, test_loss 7.125179, test_acc: 19.6332
Epoch: [ 7/40], cls_loss: 0.1622, transfer_loss: 0.0496, transfer_loss: 0.3300, total_Loss: 0.5489, test_loss 7.482588, test_acc: 19.1510
Epoch: [ 8/40], cls_loss: 0.1258, transfer_loss: 0.0805, transfer_loss: 0.3227, total_Loss: 0.5355, test_loss 7.509508, test_acc: 18.8496
Epoch: [ 9/40], cls_loss: 0.1035, transfer_loss: 0.1583, transfer_loss: 0.3189, total_Loss: 0.5874, test_loss 7.377003, test_acc: 19.8484
Epoch: [10/40], cls_loss: 0.0907, transfer_loss: 0.2062, transfer_loss: 0.3174, total_Loss: 0.6209, test_loss 7.386014, test_acc: 19.3576
Epoch: [11/40], cls_loss: 0.0830, transfer_loss: 0.3185, transfer_loss: 0.3175, total_Loss: 0.7255, test_loss 6.897172, test_acc: 20.7870
Epoch: [12/40], cls_loss: 0.0774, transfer_loss: 0.3422, transfer_loss: 0.3176, total_Loss: 0.7435, test_loss 6.879458, test_acc: 20.7784
Epoch: [13/40], cls_loss: 0.0757, transfer_loss: 0.4475, transfer_loss: 0.3182, total_Loss: 0.8487, test_loss 6.332429, test_acc: 22.1304
Epoch: [14/40], cls_loss: 0.0788, transfer_loss: 0.5489, transfer_loss: 0.3199, total_Loss: 0.9553, test_loss 6.157909, test_acc: 21.5965
Epoch: [15/40], cls_loss: 0.0811, transfer_loss: 0.6052, transfer_loss: 0.3187, total_Loss: 1.0126, test_loss 5.959382, test_acc: 20.4426
Epoch: [16/40], cls_loss: 0.0754, transfer_loss: 0.6829, transfer_loss: 0.3180, total_Loss: 1.0844, test_loss 5.867939, test_acc: 20.9937
Epoch: [17/40], cls_loss: 0.0785, transfer_loss: 0.7450, transfer_loss: 0.3180, total_Loss: 1.1490, test_loss 5.621145, test_acc: 20.0034
Epoch: [18/40], cls_loss: 0.0767, transfer_loss: 0.8053, transfer_loss: 0.3177, total_Loss: 1.2075, test_loss 5.599264, test_acc: 21.6912
Epoch: [19/40], cls_loss: 0.0757, transfer_loss: 0.8620, transfer_loss: 0.3162, total_Loss: 1.2616, test_loss 5.663611, test_acc: 20.3565
Epoch: [20/40], cls_loss: 0.0737, transfer_loss: 0.8997, transfer_loss: 0.3153, total_Loss: 1.2962, test_loss 5.555506, test_acc: 20.4426
Epoch: [21/40], cls_loss: 0.0694, transfer_loss: 0.9390, transfer_loss: 0.3139, total_Loss: 1.3295, test_loss 5.364733, test_acc: 21.6223
Epoch: [22/40], cls_loss: 0.0658, transfer_loss: 0.9702, transfer_loss: 0.3133, total_Loss: 1.3554, test_loss 5.376846, test_acc: 21.4243
Epoch: [23/40], cls_loss: 0.0688, transfer_loss: 1.0080, transfer_loss: 0.3118, total_Loss: 1.3954, test_loss 5.239729, test_acc: 21.9754
Epoch: [24/40], cls_loss: 0.0674, transfer_loss: 1.0329, transfer_loss: 0.3111, total_Loss: 1.4177, test_loss 5.173047, test_acc: 21.4759
Epoch: [25/40], cls_loss: 0.0653, transfer_loss: 1.0627, transfer_loss: 0.3104, total_Loss: 1.4445, test_loss 5.367388, test_acc: 21.2865
Epoch: [26/40], cls_loss: 0.0640, transfer_loss: 1.0790, transfer_loss: 0.3086, total_Loss: 1.4577, test_loss 5.377791, test_acc: 22.6040
Epoch: [27/40], cls_loss: 0.0596, transfer_loss: 1.0968, transfer_loss: 0.3080, total_Loss: 1.4704, test_loss 5.408702, test_acc: 23.0259
Epoch: [28/40], cls_loss: 0.0601, transfer_loss: 1.1161, transfer_loss: 0.3065, total_Loss: 1.4883, test_loss 5.452875, test_acc: 23.2670
Epoch: [29/40], cls_loss: 0.0574, transfer_loss: 1.1315, transfer_loss: 0.3054, total_Loss: 1.4998, test_loss 5.469627, test_acc: 22.3112
Epoch: [30/40], cls_loss: 0.0566, transfer_loss: 1.1489, transfer_loss: 0.3049, total_Loss: 1.5159, test_loss 5.317075, test_acc: 23.0604
Epoch: [31/40], cls_loss: 0.0553, transfer_loss: 1.1620, transfer_loss: 0.3045, total_Loss: 1.5273, test_loss 5.360532, test_acc: 21.3640
Epoch: [32/40], cls_loss: 0.0522, transfer_loss: 1.1717, transfer_loss: 0.3033, total_Loss: 1.5322, test_loss 5.288747, test_acc: 22.0270
Epoch: [33/40], cls_loss: 0.0524, transfer_loss: 1.1820, transfer_loss: 0.3026, total_Loss: 1.5419, test_loss 5.732591, test_acc: 21.2865
Epoch: [34/40], cls_loss: 0.0510, transfer_loss: 1.1909, transfer_loss: 0.3014, total_Loss: 1.5484, test_loss 5.227246, test_acc: 22.1218
Epoch: [35/40], cls_loss: 0.0486, transfer_loss: 1.1972, transfer_loss: 0.3003, total_Loss: 1.5509, test_loss 5.377791, test_acc: 23.0690
Epoch: [36/40], cls_loss: 0.0472, transfer_loss: 1.2046, transfer_loss: 0.2999, total_Loss: 1.5563, test_loss 5.413329, test_acc: 21.8118
Epoch: [37/40], cls_loss: 0.0413, transfer_loss: 1.2141, transfer_loss: 0.2991, total_Loss: 1.5593, test_loss 5.484040, test_acc: 21.8376
Epoch: [38/40], cls_loss: 0.0469, transfer_loss: 1.2225, transfer_loss: 0.2989, total_Loss: 1.5729, test_loss 5.310391, test_acc: 21.2607
Epoch: [39/40], cls_loss: 0.0417, transfer_loss: 1.2282, transfer_loss: 0.2975, total_Loss: 1.5721, test_loss 5.625070, test_acc: 20.2704
Epoch: [40/40], cls_loss: 0.0430, transfer_loss: 1.2339, transfer_loss: 0.2972, total_Loss: 1.5780, test_loss 5.391058, test_acc: 22.2337
Transfer result: 23.2670

Namespace(backbone='swimvit', batch_size=32, beta=0, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/datasets/', dataset='Oulu', device=device(type='cuda', index=5), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=50, n_iter_per_epoch=300, nav_t=1, num_workers=3, s_par=0.5, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32917
Validation set size: 3362
Epoch: [ 1/50], cls_loss: 1.4109, transfer_loss: 0.7523, prototype_loss: 0.5030, total_Loss: 2.6662, test_loss 21.178794, test_acc: 30.2201
Epoch: [ 2/50], cls_loss: 1.0884, transfer_loss: 0.2101, prototype_loss: 0.3940, total_Loss: 1.6924, test_loss 16.033228, test_acc: 40.4819
Epoch: [ 3/50], cls_loss: 0.9354, transfer_loss: 0.3782, prototype_loss: 0.3955, total_Loss: 1.7091, test_loss 13.417297, test_acc: 41.9393
Epoch: [ 4/50], cls_loss: 0.8455, transfer_loss: 0.0967, prototype_loss: 0.3814, total_Loss: 1.3235, test_loss 19.054979, test_acc: 33.4325
Epoch: [ 5/50], cls_loss: 0.7646, transfer_loss: 0.4661, prototype_loss: 0.3996, total_Loss: 1.6304, test_loss 7.443093, test_acc: 49.0482
Epoch: [ 6/50], cls_loss: 0.7395, transfer_loss: 0.8931, prototype_loss: 0.4139, total_Loss: 2.0465, test_loss 6.083908, test_acc: 39.9465
Epoch: [ 7/50], cls_loss: 0.6450, transfer_loss: 1.0210, prototype_loss: 0.4174, total_Loss: 2.0834, test_loss 7.436896, test_acc: 38.8459
Epoch: [ 8/50], cls_loss: 0.6365, transfer_loss: 1.1601, prototype_loss: 0.4115, total_Loss: 2.2081, test_loss 9.849383, test_acc: 47.0851
Epoch: [ 9/50], cls_loss: 0.5793, transfer_loss: 1.2017, prototype_loss: 0.4130, total_Loss: 2.1940, test_loss 12.303781, test_acc: 53.0934
Epoch: [10/50], cls_loss: 0.5173, transfer_loss: 1.2369, prototype_loss: 0.4120, total_Loss: 2.1662, test_loss 15.623783, test_acc: 49.9405
Epoch: [11/50], cls_loss: 0.4906, transfer_loss: 1.1866, prototype_loss: 0.4178, total_Loss: 2.0950, test_loss 13.909126, test_acc: 56.1868
Epoch: [12/50], cls_loss: 0.4689, transfer_loss: 1.3436, prototype_loss: 0.4224, total_Loss: 2.2348, test_loss 5.642528, test_acc: 43.2183
Epoch: [13/50], cls_loss: 0.4171, transfer_loss: 1.3194, prototype_loss: 0.4191, total_Loss: 2.1556, test_loss 13.696415, test_acc: 40.8090
Epoch: [14/50], cls_loss: 0.4308, transfer_loss: 1.2760, prototype_loss: 0.4219, total_Loss: 2.1288, test_loss 7.760781, test_acc: 44.2594
Epoch: [15/50], cls_loss: 0.4395, transfer_loss: 1.3439, prototype_loss: 0.4289, total_Loss: 2.2123, test_loss 13.774764, test_acc: 51.3682
Epoch: [16/50], cls_loss: 0.3593, transfer_loss: 1.3421, prototype_loss: 0.4203, total_Loss: 2.1217, test_loss 13.875303, test_acc: 54.3724
Epoch: [17/50], cls_loss: 0.3186, transfer_loss: 1.3512, prototype_loss: 0.4256, total_Loss: 2.0954, test_loss 10.889105, test_acc: 51.1600
Epoch: [18/50], cls_loss: 0.3209, transfer_loss: 1.3623, prototype_loss: 0.4310, total_Loss: 2.1141, test_loss 6.777671, test_acc: 53.4206
Epoch: [19/50], cls_loss: 0.2886, transfer_loss: 1.3725, prototype_loss: 0.4283, total_Loss: 2.0895, test_loss 25.295835, test_acc: 43.2183
Epoch: [20/50], cls_loss: 0.2817, transfer_loss: 1.3355, prototype_loss: 0.4313, total_Loss: 2.0485, test_loss 8.598464, test_acc: 58.3284
Epoch: [21/50], cls_loss: 0.2661, transfer_loss: 1.3640, prototype_loss: 0.4336, total_Loss: 2.0637, test_loss 10.131772, test_acc: 54.5211
Epoch: [22/50], cls_loss: 0.2547, transfer_loss: 1.3417, prototype_loss: 0.4402, total_Loss: 2.0367, test_loss 13.107451, test_acc: 57.9417
Epoch: [23/50], cls_loss: 0.2416, transfer_loss: 1.3800, prototype_loss: 0.4459, total_Loss: 2.0675, test_loss 10.011449, test_acc: 60.3807
Epoch: [24/50], cls_loss: 0.2534, transfer_loss: 1.3741, prototype_loss: 0.4505, total_Loss: 2.0780, test_loss 8.388975, test_acc: 60.0833
Epoch: [25/50], cls_loss: 0.2250, transfer_loss: 1.3982, prototype_loss: 0.4486, total_Loss: 2.0718, test_loss 10.849439, test_acc: 56.0381
Epoch: [26/50], cls_loss: 0.2080, transfer_loss: 1.3562, prototype_loss: 0.4544, total_Loss: 2.0185, test_loss 10.402839, test_acc: 52.4093
Epoch: [27/50], cls_loss: 0.1957, transfer_loss: 1.3884, prototype_loss: 0.4513, total_Loss: 2.0353, test_loss 11.680968, test_acc: 52.5283
Epoch: [28/50], cls_loss: 0.1806, transfer_loss: 1.3603, prototype_loss: 0.4546, total_Loss: 1.9955, test_loss 11.712085, test_acc: 57.7037
Epoch: [29/50], cls_loss: 0.1730, transfer_loss: 1.4002, prototype_loss: 0.4608, total_Loss: 2.0340, test_loss 13.641299, test_acc: 58.0309
Epoch: [30/50], cls_loss: 0.1655, transfer_loss: 1.3844, prototype_loss: 0.4609, total_Loss: 2.0108, test_loss 12.051853, test_acc: 57.3171
Epoch: [31/50], cls_loss: 0.1555, transfer_loss: 1.3975, prototype_loss: 0.4633, total_Loss: 2.0163, test_loss 14.424203, test_acc: 54.2832
Epoch: [32/50], cls_loss: 0.1676, transfer_loss: 1.3756, prototype_loss: 0.4632, total_Loss: 2.0064, test_loss 6.974458, test_acc: 60.1725
Epoch: [33/50], cls_loss: 0.1600, transfer_loss: 1.3853, prototype_loss: 0.4669, total_Loss: 2.0122, test_loss 12.631246, test_acc: 58.2391
Epoch: [34/50], cls_loss: 0.1498, transfer_loss: 1.3876, prototype_loss: 0.4697, total_Loss: 2.0071, test_loss 15.686656, test_acc: 55.4432
Epoch: [35/50], cls_loss: 0.1343, transfer_loss: 1.3910, prototype_loss: 0.4694, total_Loss: 1.9947, test_loss 11.194420, test_acc: 53.2719
Epoch: [36/50], cls_loss: 0.1428, transfer_loss: 1.3734, prototype_loss: 0.4713, total_Loss: 1.9875, test_loss 8.258649, test_acc: 57.8822
Epoch: [37/50], cls_loss: 0.1426, transfer_loss: 1.3894, prototype_loss: 0.4756, total_Loss: 2.0076, test_loss 11.573934, test_acc: 60.0833
Epoch: [38/50], cls_loss: 0.1200, transfer_loss: 1.3688, prototype_loss: 0.4784, total_Loss: 1.9672, test_loss 15.191147, test_acc: 57.5848
Epoch: [39/50], cls_loss: 0.1198, transfer_loss: 1.4020, prototype_loss: 0.4800, total_Loss: 2.0017, test_loss 14.547381, test_acc: 54.9375
Epoch: [40/50], cls_loss: 0.1187, transfer_loss: 1.3943, prototype_loss: 0.4809, total_Loss: 1.9938, test_loss 11.248695, test_acc: 58.3284
Epoch: [41/50], cls_loss: 0.1038, transfer_loss: 1.3691, prototype_loss: 0.4858, total_Loss: 1.9587, test_loss 13.025993, test_acc: 56.0678
Epoch: [42/50], cls_loss: 0.1095, transfer_loss: 1.4150, prototype_loss: 0.4852, total_Loss: 2.0097, test_loss 19.624052, test_acc: 51.9631
Epoch: [43/50], cls_loss: 0.1125, transfer_loss: 1.3941, prototype_loss: 0.4901, total_Loss: 1.9966, test_loss 11.955048, test_acc: 60.7971
Epoch: [44/50], cls_loss: 0.1077, transfer_loss: 1.3880, prototype_loss: 0.4851, total_Loss: 1.9809, test_loss 12.157936, test_acc: 58.8638
Epoch: [45/50], cls_loss: 0.0841, transfer_loss: 1.3951, prototype_loss: 0.4863, total_Loss: 1.9656, test_loss 6.072094, test_acc: 64.2772
Epoch: [46/50], cls_loss: 0.1157, transfer_loss: 1.3857, prototype_loss: 0.4844, total_Loss: 1.9859, test_loss 8.729521, test_acc: 62.5223
Epoch: [47/50], cls_loss: 0.0835, transfer_loss: 1.3886, prototype_loss: 0.4858, total_Loss: 1.9579, test_loss 8.624009, test_acc: 62.0464
Epoch: [48/50], cls_loss: 0.0816, transfer_loss: 1.3896, prototype_loss: 0.4853, total_Loss: 1.9565, test_loss 8.487706, test_acc: 59.1315
Epoch: [49/50], cls_loss: 0.0962, transfer_loss: 1.4064, prototype_loss: 0.4872, total_Loss: 1.9898, test_loss 10.442408, test_acc: 60.1428
Epoch: [50/50], cls_loss: 0.0847, transfer_loss: 1.3817, prototype_loss: 0.4889, total_Loss: 1.9553, test_loss 7.154571, test_acc: 63.1469
Transfer result: 64.2772

#加mixup后
Namespace(backbone='swimvit', batch_size=32, beta=0, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/datasets/', dataset='Oulu', device=device(type='cuda', index=5), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=50, n_iter_per_epoch=300, nav_t=1, num_workers=3, s_par=0.5, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32917
Validation set size: 3362
Epoch: [ 1/50], cls_loss: 1.4870, transfer_loss: 0.8087, prototype_loss: 0.5515, total_Loss: 4.3993, test_loss 6.837313, test_acc: 38.3403
Epoch: [ 2/50], cls_loss: 1.1513, transfer_loss: 0.2869, prototype_loss: 0.3930, total_Loss: 3.3050, test_loss 6.344062, test_acc: 55.0863
Epoch: [ 3/50], cls_loss: 0.9907, transfer_loss: 0.2054, prototype_loss: 0.3644, total_Loss: 2.9851, test_loss 7.991983, test_acc: 30.9340
Epoch: [ 4/50], cls_loss: 0.8926, transfer_loss: 0.9395, prototype_loss: 0.3710, total_Loss: 3.5754, test_loss 7.174883, test_acc: 49.2861
Epoch: [ 5/50], cls_loss: 0.8015, transfer_loss: 1.1643, prototype_loss: 0.3852, total_Loss: 3.7073, test_loss 9.081611, test_acc: 51.1600
Epoch: [ 6/50], cls_loss: 0.7443, transfer_loss: 1.2538, prototype_loss: 0.3920, total_Loss: 3.7395, test_loss 6.916285, test_acc: 55.6217
Epoch: [ 7/50], cls_loss: 0.6996, transfer_loss: 1.2893, prototype_loss: 0.3827, total_Loss: 3.7427, test_loss 16.176960, test_acc: 45.2112
Epoch: [ 8/50], cls_loss: 0.6548, transfer_loss: 1.2843, prototype_loss: 0.3760, total_Loss: 3.6198, test_loss 6.367908, test_acc: 58.8043
Epoch: [ 9/50], cls_loss: 0.5976, transfer_loss: 1.3752, prototype_loss: 0.3761, total_Loss: 3.6610, test_loss 10.269061, test_acc: 53.3908
Epoch: [10/50], cls_loss: 0.5511, transfer_loss: 1.3146, prototype_loss: 0.3686, total_Loss: 3.5428, test_loss 10.100878, test_acc: 53.7775
Epoch: [11/50], cls_loss: 0.5085, transfer_loss: 1.3606, prototype_loss: 0.3782, total_Loss: 3.5194, test_loss 6.247040, test_acc: 63.2659
Epoch: [12/50], cls_loss: 0.4926, transfer_loss: 1.3960, prototype_loss: 0.3774, total_Loss: 3.5083, test_loss 8.539647, test_acc: 56.3950
Epoch: [13/50], cls_loss: 0.4644, transfer_loss: 1.3613, prototype_loss: 0.3764, total_Loss: 3.4540, test_loss 8.791826, test_acc: 55.5027
Epoch: [14/50], cls_loss: 0.4582, transfer_loss: 1.3774, prototype_loss: 0.3794, total_Loss: 3.4565, test_loss 9.925757, test_acc: 62.8495
Epoch: [15/50], cls_loss: 0.4201, transfer_loss: 1.3632, prototype_loss: 0.3850, total_Loss: 3.3839, test_loss 11.923325, test_acc: 57.0196
Epoch: [16/50], cls_loss: 0.3872, transfer_loss: 1.3839, prototype_loss: 0.3917, total_Loss: 3.3700, test_loss 4.899880, test_acc: 62.6413
Epoch: [17/50], cls_loss: 0.3698, transfer_loss: 1.3812, prototype_loss: 0.3902, total_Loss: 3.3223, test_loss 9.698455, test_acc: 63.2064
Epoch: [18/50], cls_loss: 0.3319, transfer_loss: 1.3820, prototype_loss: 0.3950, total_Loss: 3.2830, test_loss 8.592505, test_acc: 64.1285
Epoch: [19/50], cls_loss: 0.3347, transfer_loss: 1.3943, prototype_loss: 0.4017, total_Loss: 3.2787, test_loss 10.707930, test_acc: 60.8269
Epoch: [20/50], cls_loss: 0.3130, transfer_loss: 1.3675, prototype_loss: 0.4053, total_Loss: 3.2606, test_loss 13.978687, test_acc: 59.0125
Epoch: [21/50], cls_loss: 0.2908, transfer_loss: 1.3720, prototype_loss: 0.4093, total_Loss: 3.2142, test_loss 9.360171, test_acc: 61.6002
Epoch: [22/50], cls_loss: 0.2839, transfer_loss: 1.3863, prototype_loss: 0.4164, total_Loss: 3.2353, test_loss 7.875379, test_acc: 66.3891
Epoch: [23/50], cls_loss: 0.2410, transfer_loss: 1.4091, prototype_loss: 0.4153, total_Loss: 3.1879, test_loss 10.852449, test_acc: 63.6228
Epoch: [24/50], cls_loss: 0.2606, transfer_loss: 1.3733, prototype_loss: 0.4148, total_Loss: 3.1835, test_loss 10.882144, test_acc: 66.4188
Epoch: [25/50], cls_loss: 0.2337, transfer_loss: 1.3861, prototype_loss: 0.4270, total_Loss: 3.1743, test_loss 6.726379, test_acc: 61.9572
Epoch: [26/50], cls_loss: 0.2222, transfer_loss: 1.3845, prototype_loss: 0.4243, total_Loss: 3.1172, test_loss 7.444133, test_acc: 61.9869
Epoch: [27/50], cls_loss: 0.1994, transfer_loss: 1.3969, prototype_loss: 0.4281, total_Loss: 3.1124, test_loss 10.081929, test_acc: 58.0904
Epoch: [28/50], cls_loss: 0.1943, transfer_loss: 1.3821, prototype_loss: 0.4324, total_Loss: 3.0773, test_loss 10.069701, test_acc: 61.1243
Epoch: [29/50], cls_loss: 0.1893, transfer_loss: 1.3929, prototype_loss: 0.4316, total_Loss: 3.0886, test_loss 11.200792, test_acc: 63.1469
Epoch: [30/50], cls_loss: 0.1862, transfer_loss: 1.3844, prototype_loss: 0.4350, total_Loss: 3.0673, test_loss 12.153783, test_acc: 64.3664
Epoch: [31/50], cls_loss: 0.1818, transfer_loss: 1.3795, prototype_loss: 0.4419, total_Loss: 3.0799, test_loss 12.491509, test_acc: 61.7192
Epoch: [32/50], cls_loss: 0.1805, transfer_loss: 1.3905, prototype_loss: 0.4432, total_Loss: 3.0924, test_loss 12.185752, test_acc: 64.3962
Epoch: [33/50], cls_loss: 0.1661, transfer_loss: 1.3943, prototype_loss: 0.4400, total_Loss: 3.0476, test_loss 12.254418, test_acc: 65.7049
Epoch: [34/50], cls_loss: 0.1672, transfer_loss: 1.4016, prototype_loss: 0.4399, total_Loss: 3.0667, test_loss 10.089775, test_acc: 63.8608
Epoch: [35/50], cls_loss: 0.1486, transfer_loss: 1.3924, prototype_loss: 0.4473, total_Loss: 3.0379, test_loss 7.036641, test_acc: 65.4967
Epoch: [36/50], cls_loss: 0.1424, transfer_loss: 1.3873, prototype_loss: 0.4437, total_Loss: 3.0109, test_loss 9.265979, test_acc: 65.0506
Epoch: [37/50], cls_loss: 0.1449, transfer_loss: 1.3853, prototype_loss: 0.4451, total_Loss: 3.0275, test_loss 9.977258, test_acc: 63.5039
Epoch: [38/50], cls_loss: 0.1380, transfer_loss: 1.3939, prototype_loss: 0.4467, total_Loss: 3.0091, test_loss 10.640338, test_acc: 65.1993
Epoch: [39/50], cls_loss: 0.1309, transfer_loss: 1.3798, prototype_loss: 0.4503, total_Loss: 2.9827, test_loss 10.744067, test_acc: 63.4146
Epoch: [40/50], cls_loss: 0.1202, transfer_loss: 1.3872, prototype_loss: 0.4509, total_Loss: 2.9714, test_loss 10.240895, test_acc: 65.8239
Epoch: [41/50], cls_loss: 0.1131, transfer_loss: 1.3923, prototype_loss: 0.4510, total_Loss: 2.9598, test_loss 9.310734, test_acc: 65.7049
Epoch: [42/50], cls_loss: 0.1088, transfer_loss: 1.3848, prototype_loss: 0.4519, total_Loss: 2.9415, test_loss 7.187719, test_acc: 67.6383
Epoch: [43/50], cls_loss: 0.1109, transfer_loss: 1.3872, prototype_loss: 0.4546, total_Loss: 2.9370, test_loss 9.473863, test_acc: 65.1101
Epoch: [44/50], cls_loss: 0.1243, transfer_loss: 1.3885, prototype_loss: 0.4562, total_Loss: 2.9654, test_loss 6.777662, test_acc: 64.6341
Epoch: [45/50], cls_loss: 0.0979, transfer_loss: 1.3831, prototype_loss: 0.4559, total_Loss: 2.9182, test_loss 7.930663, test_acc: 65.0803
Epoch: [46/50], cls_loss: 0.1040, transfer_loss: 1.3852, prototype_loss: 0.4569, total_Loss: 2.9285, test_loss 9.239638, test_acc: 66.2106
Epoch: [47/50], cls_loss: 0.0931, transfer_loss: 1.3917, prototype_loss: 0.4589, total_Loss: 2.8926, test_loss 10.154619, test_acc: 65.0803
Epoch: [48/50], cls_loss: 0.0852, transfer_loss: 1.3848, prototype_loss: 0.4609, total_Loss: 2.8922, test_loss 9.798279, test_acc: 65.1398
Epoch: [49/50], cls_loss: 0.0928, transfer_loss: 1.3825, prototype_loss: 0.4618, total_Loss: 2.9049, test_loss 11.140294, test_acc: 63.5634
Epoch: [50/50], cls_loss: 0.0813, transfer_loss: 1.3865, prototype_loss: 0.4617, total_Loss: 2.8854, test_loss 13.429541, test_acc: 65.3183
Transfer result: 67.6383



Namespace(backbone='swimvit', batch_size=32, beta=0, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/datasets/', dataset='NVIE', device=device(type='cuda', index=5), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=50, n_iter_per_epoch=300, nav_t=1, num_workers=3, s_par=0.5, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32274
Validation set size: 11613
Epoch: [ 1/50], cls_loss: 1.0027, transfer_loss: 0.2871, prototype_loss: 0.4368, total_Loss: 3.1301, test_loss 26.061656, test_acc: 15.9390
Epoch: [ 2/50], cls_loss: 0.3057, transfer_loss: 0.1449, prototype_loss: 0.4299, total_Loss: 1.9971, test_loss 22.058038, test_acc: 14.4665
Epoch: [ 3/50], cls_loss: 0.1613, transfer_loss: 0.8382, prototype_loss: 0.4636, total_Loss: 2.5553, test_loss 16.030054, test_acc: 13.7260
Epoch: [ 4/50], cls_loss: 0.1268, transfer_loss: 1.2162, prototype_loss: 0.4577, total_Loss: 2.8850, test_loss 27.981816, test_acc: 15.8185
Epoch: [ 5/50], cls_loss: 0.0887, transfer_loss: 1.3046, prototype_loss: 0.4432, total_Loss: 2.9025, test_loss 21.437299, test_acc: 13.8207
Epoch: [ 6/50], cls_loss: 0.0606, transfer_loss: 1.2865, prototype_loss: 0.4404, total_Loss: 2.8069, test_loss 23.761237, test_acc: 15.6549
Epoch: [ 7/50], cls_loss: 0.0517, transfer_loss: 1.3515, prototype_loss: 0.4369, total_Loss: 2.8477, test_loss 38.228743, test_acc: 19.4437
Epoch: [ 8/50], cls_loss: 0.0637, transfer_loss: 1.3807, prototype_loss: 0.4438, total_Loss: 2.9085, test_loss 14.383542, test_acc: 17.8249
Epoch: [ 9/50], cls_loss: 0.0384, transfer_loss: 1.3792, prototype_loss: 0.4237, total_Loss: 2.8544, test_loss 11.817550, test_acc: 17.6526
Epoch: [10/50], cls_loss: 0.0462, transfer_loss: 1.3866, prototype_loss: 0.4351, total_Loss: 2.8864, test_loss 13.972693, test_acc: 15.5343
Epoch: [11/50], cls_loss: 0.0242, transfer_loss: 1.3659, prototype_loss: 0.4213, total_Loss: 2.8084, test_loss 22.222570, test_acc: 14.0360
Epoch: [12/50], cls_loss: 0.0320, transfer_loss: 1.3666, prototype_loss: 0.4329, total_Loss: 2.8219, test_loss 16.431040, test_acc: 17.3426
Epoch: [13/50], cls_loss: 0.0321, transfer_loss: 1.3931, prototype_loss: 0.4335, total_Loss: 2.8473, test_loss 29.321754, test_acc: 17.3340
Epoch: [14/50], cls_loss: 0.0234, transfer_loss: 1.3932, prototype_loss: 0.4311, total_Loss: 2.8326, test_loss 21.568784, test_acc: 15.3621
Epoch: [15/50], cls_loss: 0.0206, transfer_loss: 1.3813, prototype_loss: 0.4248, total_Loss: 2.8045, test_loss 30.825592, test_acc: 17.7732
Epoch: [16/50], cls_loss: 0.0144, transfer_loss: 1.3713, prototype_loss: 0.4238, total_Loss: 2.7960, test_loss 44.907064, test_acc: 17.1360
Epoch: [17/50], cls_loss: 0.0246, transfer_loss: 1.3678, prototype_loss: 0.4262, total_Loss: 2.8121, test_loss 25.405040, test_acc: 17.9626
Epoch: [18/50], cls_loss: 0.0175, transfer_loss: 1.3673, prototype_loss: 0.4373, total_Loss: 2.8010, test_loss 36.384068, test_acc: 16.4729
Epoch: [19/50], cls_loss: 0.0261, transfer_loss: 1.2824, prototype_loss: 0.4677, total_Loss: 2.7018, test_loss 22.560574, test_acc: 15.6118
Epoch: [20/50], cls_loss: 0.0166, transfer_loss: 1.3725, prototype_loss: 0.4583, total_Loss: 2.8213, test_loss 24.315386, test_acc: 15.9390
Epoch: [21/50], cls_loss: 0.0137, transfer_loss: 1.3744, prototype_loss: 0.4560, total_Loss: 2.8233, test_loss 23.057491, test_acc: 17.0154
Epoch: [22/50], cls_loss: 0.0151, transfer_loss: 1.3678, prototype_loss: 0.4599, total_Loss: 2.8250, test_loss 17.004338, test_acc: 18.6429
Epoch: [23/50], cls_loss: 0.0139, transfer_loss: 1.3580, prototype_loss: 0.4679, total_Loss: 2.8164, test_loss 10.061849, test_acc: 19.8226
Epoch: [24/50], cls_loss: 0.0151, transfer_loss: 1.3771, prototype_loss: 0.4638, total_Loss: 2.8313, test_loss 14.365437, test_acc: 19.4265
Epoch: [25/50], cls_loss: 0.0099, transfer_loss: 1.3586, prototype_loss: 0.4595, total_Loss: 2.8068, test_loss 21.150694, test_acc: 15.1727
Epoch: [26/50], cls_loss: 0.0147, transfer_loss: 1.3674, prototype_loss: 0.4642, total_Loss: 2.8347, test_loss 17.205376, test_acc: 16.7226
Epoch: [27/50], cls_loss: 0.0100, transfer_loss: 1.3835, prototype_loss: 0.4638, total_Loss: 2.8382, test_loss 21.191779, test_acc: 15.9735
Epoch: [28/50], cls_loss: 0.0067, transfer_loss: 1.3762, prototype_loss: 0.4631, total_Loss: 2.8263, test_loss 19.342834, test_acc: 17.4804
Epoch: [29/50], cls_loss: 0.0084, transfer_loss: 1.3771, prototype_loss: 0.4690, total_Loss: 2.8334, test_loss 24.901386, test_acc: 16.5332
Epoch: [30/50], cls_loss: 0.0229, transfer_loss: 1.3490, prototype_loss: 0.4786, total_Loss: 2.8413, test_loss 9.552024, test_acc: 18.2812
Epoch: [31/50], cls_loss: 0.0106, transfer_loss: 1.3706, prototype_loss: 0.4802, total_Loss: 2.8419, test_loss 19.344677, test_acc: 16.0424
Epoch: [32/50], cls_loss: 0.0096, transfer_loss: 1.3777, prototype_loss: 0.4774, total_Loss: 2.8488, test_loss 11.070766, test_acc: 15.4568
Epoch: [33/50], cls_loss: 0.0054, transfer_loss: 1.3823, prototype_loss: 0.4821, total_Loss: 2.8462, test_loss 4.316348, test_acc: 19.8571
Epoch: [34/50], cls_loss: 0.0053, transfer_loss: 1.3772, prototype_loss: 0.4887, total_Loss: 2.8456, test_loss 13.361664, test_acc: 14.1307
Epoch: [35/50], cls_loss: 0.0040, transfer_loss: 1.3905, prototype_loss: 0.4940, total_Loss: 2.8632, test_loss 10.441022, test_acc: 16.4643
Epoch: [36/50], cls_loss: 0.0107, transfer_loss: 1.3022, prototype_loss: 0.5081, total_Loss: 2.7776, test_loss 8.297473, test_acc: 20.0293
Epoch: [37/50], cls_loss: 0.0175, transfer_loss: 1.3230, prototype_loss: 0.5335, total_Loss: 2.8165, test_loss 10.235828, test_acc: 16.1543
Epoch: [38/50], cls_loss: 0.0072, transfer_loss: 1.3757, prototype_loss: 0.5201, total_Loss: 2.8687, test_loss 14.498540, test_acc: 15.0952
Epoch: [39/50], cls_loss: 0.0047, transfer_loss: 1.3787, prototype_loss: 0.5177, total_Loss: 2.8610, test_loss 19.977126, test_acc: 16.1457
Epoch: [40/50], cls_loss: 0.0094, transfer_loss: 1.3875, prototype_loss: 0.5174, total_Loss: 2.8909, test_loss 82.703113, test_acc: 13.8379
Epoch: [41/50], cls_loss: 0.0072, transfer_loss: 1.3726, prototype_loss: 0.5215, total_Loss: 2.8762, test_loss 31.222596, test_acc: 16.3954
Epoch: [42/50], cls_loss: 0.0106, transfer_loss: 1.3853, prototype_loss: 0.5183, total_Loss: 2.8803, test_loss 17.398810, test_acc: 19.8312
Epoch: [43/50], cls_loss: 0.0066, transfer_loss: 1.3960, prototype_loss: 0.5200, total_Loss: 2.8913, test_loss 26.753660, test_acc: 19.6504
Epoch: [44/50], cls_loss: 0.0065, transfer_loss: 1.3911, prototype_loss: 0.5192, total_Loss: 2.8822, test_loss 10.686236, test_acc: 20.5890
Epoch: [45/50], cls_loss: 0.0080, transfer_loss: 1.3958, prototype_loss: 0.5228, total_Loss: 2.9034, test_loss 21.349579, test_acc: 17.3599
Epoch: [46/50], cls_loss: 0.0078, transfer_loss: 1.3940, prototype_loss: 0.5280, total_Loss: 2.8968, test_loss 32.207761, test_acc: 19.6332
Epoch: [47/50], cls_loss: 0.0108, transfer_loss: 1.3915, prototype_loss: 0.5349, total_Loss: 2.9067, test_loss 15.714319, test_acc: 19.1596
Epoch: [48/50], cls_loss: 0.0077, transfer_loss: 1.3866, prototype_loss: 0.5314, total_Loss: 2.8903, test_loss 18.204270, test_acc: 19.6332
Epoch: [49/50], cls_loss: 0.0042, transfer_loss: 1.3920, prototype_loss: 0.5305, total_Loss: 2.8967, test_loss 31.520719, test_acc: 18.0143
Epoch: [50/50], cls_loss: 0.0166, transfer_loss: 1.3848, prototype_loss: 0.5437, total_Loss: 2.9175, test_loss 14.849926, test_acc: 17.5235
Transfer result: 20.5890

#batch_size = 16;+atten;
Namespace(backbone='swimvit', batch_size=16, beta=0, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/datasets/', dataset='Oulu', device=device(type='cuda', index=1), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=50, n_iter_per_epoch=300, nav_t=1, num_workers=3, s_par=0.5, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32917
Validation set size: 3362
Epoch: [ 1/50], cls_loss: 1.4609, transfer_loss: 1.3323, prototype_loss: 0.0000, attention_loss: 0.0090, total_Loss: 2.8022, test_loss 1.175628, test_acc: 52.1118
Epoch: [ 2/50], cls_loss: 1.1174, transfer_loss: 1.3764, prototype_loss: 0.0000, attention_loss: 0.0043, total_Loss: 2.4981, test_loss 1.145535, test_acc: 54.9970
Epoch: [ 3/50], cls_loss: 0.9592, transfer_loss: 1.3794, prototype_loss: 0.0000, attention_loss: 0.0032, total_Loss: 2.3417, test_loss 0.987118, test_acc: 62.7305
Epoch: [ 4/50], cls_loss: 0.8433, transfer_loss: 1.3750, prototype_loss: 0.0000, attention_loss: 0.0025, total_Loss: 2.2208, test_loss 0.890886, test_acc: 66.0321
Epoch: [ 5/50], cls_loss: 0.7540, transfer_loss: 1.3805, prototype_loss: 0.0000, attention_loss: 0.0019, total_Loss: 2.1364, test_loss 1.302648, test_acc: 57.6145
Epoch: [ 6/50], cls_loss: 0.7132, transfer_loss: 1.3840, prototype_loss: 0.0000, attention_loss: 0.0017, total_Loss: 2.0989, test_loss 1.080740, test_acc: 61.4218
Epoch: [ 7/50], cls_loss: 0.6270, transfer_loss: 1.3907, prototype_loss: 0.0000, attention_loss: 0.0014, total_Loss: 2.0191, test_loss 1.370308, test_acc: 59.5479
Epoch: [ 8/50], cls_loss: 0.5713, transfer_loss: 1.3814, prototype_loss: 0.0000, attention_loss: 0.0016, total_Loss: 1.9543, test_loss 1.264990, test_acc: 61.8084
Epoch: [ 9/50], cls_loss: 0.5459, transfer_loss: 1.3871, prototype_loss: 0.0000, attention_loss: 0.0015, total_Loss: 1.9344, test_loss 1.046144, test_acc: 66.1511
Epoch: [10/50], cls_loss: 0.4772, transfer_loss: 1.3874, prototype_loss: 0.0000, attention_loss: 0.0014, total_Loss: 1.8660, test_loss 1.262152, test_acc: 64.5747
Epoch: [11/50], cls_loss: 0.4659, transfer_loss: 1.3874, prototype_loss: 0.0000, attention_loss: 0.0012, total_Loss: 1.8544, test_loss 1.495095, test_acc: 61.1541
Epoch: [12/50], cls_loss: 0.4253, transfer_loss: 1.3853, prototype_loss: 0.0000, attention_loss: 0.0011, total_Loss: 1.8118, test_loss 1.187610, test_acc: 66.9839
Epoch: [13/50], cls_loss: 0.3817, transfer_loss: 1.3871, prototype_loss: 0.0000, attention_loss: 0.0010, total_Loss: 1.7697, test_loss 1.640495, test_acc: 63.8311
Epoch: [14/50], cls_loss: 0.3498, transfer_loss: 1.3871, prototype_loss: 0.0000, attention_loss: 0.0009, total_Loss: 1.7378, test_loss 1.709231, test_acc: 61.9572
Epoch: [15/50], cls_loss: 0.3486, transfer_loss: 1.3884, prototype_loss: 0.0000, attention_loss: 0.0010, total_Loss: 1.7380, test_loss 1.814708, test_acc: 66.4188
Epoch: [16/50], cls_loss: 0.2948, transfer_loss: 1.3853, prototype_loss: 0.0000, attention_loss: 0.0010, total_Loss: 1.6811, test_loss 2.005249, test_acc: 64.6044
Epoch: [17/50], cls_loss: 0.2885, transfer_loss: 1.3879, prototype_loss: 0.0000, attention_loss: 0.0009, total_Loss: 1.6773, test_loss 2.055861, test_acc: 62.0167
Epoch: [18/50], cls_loss: 0.2812, transfer_loss: 1.3868, prototype_loss: 0.0000, attention_loss: 0.0008, total_Loss: 1.6688, test_loss 1.798686, test_acc: 62.3438
Epoch: [19/50], cls_loss: 0.2628, transfer_loss: 1.3879, prototype_loss: 0.0000, attention_loss: 0.0009, total_Loss: 1.6516, test_loss 2.018437, test_acc: 61.3028
Epoch: [20/50], cls_loss: 0.2492, transfer_loss: 1.3862, prototype_loss: 0.0000, attention_loss: 0.0009, total_Loss: 1.6364, test_loss 1.734549, test_acc: 64.0690
Epoch: [21/50], cls_loss: 0.2371, transfer_loss: 1.3864, prototype_loss: 0.0000, attention_loss: 0.0009, total_Loss: 1.6245, test_loss 2.092520, test_acc: 64.9911
Epoch: [22/50], cls_loss: 0.2245, transfer_loss: 1.3878, prototype_loss: 0.0000, attention_loss: 0.0008, total_Loss: 1.6131, test_loss 2.162280, test_acc: 63.0577
Epoch: [23/50], cls_loss: 0.2108, transfer_loss: 1.3862, prototype_loss: 0.0000, attention_loss: 0.0007, total_Loss: 1.5976, test_loss 1.861398, test_acc: 65.5265
Epoch: [24/50], cls_loss: 0.1899, transfer_loss: 1.3870, prototype_loss: 0.0000, attention_loss: 0.0008, total_Loss: 1.5777, test_loss 2.078577, test_acc: 64.8424
Epoch: [25/50], cls_loss: 0.1882, transfer_loss: 1.3861, prototype_loss: 0.0000, attention_loss: 0.0007, total_Loss: 1.5749, test_loss 1.974945, test_acc: 66.0024
Epoch: [26/50], cls_loss: 0.1751, transfer_loss: 1.3869, prototype_loss: 0.0000, attention_loss: 0.0007, total_Loss: 1.5628, test_loss 1.992317, test_acc: 65.4372
Epoch: [27/50], cls_loss: 0.1689, transfer_loss: 1.3862, prototype_loss: 0.0000, attention_loss: 0.0006, total_Loss: 1.5557, test_loss 1.900698, test_acc: 65.3777
Epoch: [28/50], cls_loss: 0.1515, transfer_loss: 1.3877, prototype_loss: 0.0000, attention_loss: 0.0006, total_Loss: 1.5398, test_loss 1.878049, test_acc: 66.4783
Epoch: [29/50], cls_loss: 0.1504, transfer_loss: 1.3862, prototype_loss: 0.0000, attention_loss: 0.0006, total_Loss: 1.5372, test_loss 2.106972, test_acc: 66.4188
Epoch: [30/50], cls_loss: 0.1424, transfer_loss: 1.3846, prototype_loss: 0.0000, attention_loss: 0.0007, total_Loss: 1.5276, test_loss 2.341173, test_acc: 63.9500
Epoch: [31/50], cls_loss: 0.1419, transfer_loss: 1.3859, prototype_loss: 0.0000, attention_loss: 0.0011, total_Loss: 1.5288, test_loss 2.351794, test_acc: 64.0690
Epoch: [32/50], cls_loss: 0.1339, transfer_loss: 1.3861, prototype_loss: 0.0000, attention_loss: 0.0008, total_Loss: 1.5208, test_loss 2.994544, test_acc: 62.7900
Epoch: [33/50], cls_loss: 0.1295, transfer_loss: 1.3859, prototype_loss: 0.0000, attention_loss: 0.0008, total_Loss: 1.5162, test_loss 2.121368, test_acc: 65.4075
Epoch: [34/50], cls_loss: 0.1219, transfer_loss: 1.3868, prototype_loss: 0.0000, attention_loss: 0.0007, total_Loss: 1.5093, test_loss 2.188527, test_acc: 66.0024
Epoch: [35/50], cls_loss: 0.1060, transfer_loss: 1.3853, prototype_loss: 0.0000, attention_loss: 0.0006, total_Loss: 1.4919, test_loss 2.049708, test_acc: 69.5717
Epoch: [36/50], cls_loss: 0.1072, transfer_loss: 1.3853, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4930, test_loss 2.546613, test_acc: 64.7531
Epoch: [37/50], cls_loss: 0.1010, transfer_loss: 1.3849, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4864, test_loss 2.393518, test_acc: 66.2403
Epoch: [38/50], cls_loss: 0.0945, transfer_loss: 1.3842, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4793, test_loss 2.758556, test_acc: 65.0208
Epoch: [39/50], cls_loss: 0.1049, transfer_loss: 1.3854, prototype_loss: 0.0000, attention_loss: 0.0006, total_Loss: 1.4909, test_loss 2.244489, test_acc: 68.6794
Epoch: [40/50], cls_loss: 0.0945, transfer_loss: 1.3848, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4799, test_loss 2.706593, test_acc: 65.8537
Epoch: [41/50], cls_loss: 0.1034, transfer_loss: 1.3853, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4892, test_loss 2.592271, test_acc: 67.4896
Epoch: [42/50], cls_loss: 0.0841, transfer_loss: 1.3866, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4712, test_loss 3.225290, test_acc: 64.7829
Epoch: [43/50], cls_loss: 0.0914, transfer_loss: 1.3865, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4784, test_loss 2.834540, test_acc: 63.6228
Epoch: [44/50], cls_loss: 0.0837, transfer_loss: 1.3860, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4703, test_loss 2.702541, test_acc: 65.2588
Epoch: [45/50], cls_loss: 0.0859, transfer_loss: 1.3843, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4707, test_loss 2.212124, test_acc: 67.1624
Epoch: [46/50], cls_loss: 0.0760, transfer_loss: 1.3868, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4633, test_loss 2.924077, test_acc: 63.8608
Epoch: [47/50], cls_loss: 0.0738, transfer_loss: 1.3861, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4604, test_loss 2.614701, test_acc: 65.3777
Epoch: [48/50], cls_loss: 0.0692, transfer_loss: 1.3862, prototype_loss: 0.0000, attention_loss: 0.0004, total_Loss: 1.4558, test_loss 3.009906, test_acc: 65.0208
Epoch: [49/50], cls_loss: 0.0661, transfer_loss: 1.3858, prototype_loss: 0.0000, attention_loss: 0.0004, total_Loss: 1.4523, test_loss 2.701027, test_acc: 67.0137
Epoch: [50/50], cls_loss: 0.0703, transfer_loss: 1.3855, prototype_loss: 0.0000, attention_loss: 0.0005, total_Loss: 1.4563, test_loss 3.485838, test_acc: 60.6484
Transfer result: 69.5717
#
Namespace(backbone='swimvit', batch_size=16, beta=0, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/datasets/', dataset='Oulu', device=device(type='cuda', index=1), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=50, n_iter_per_epoch=300, nav_t=1, num_workers=3, s_par=0.5, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32917
Validation set size: 3362
Epoch: [ 1/50], cls_loss: 1.4270, transfer_loss: 0.8159, prototype_loss: 0.5158, attention_loss: 0.0095, total_Loss: 2.7682, test_loss 9.273779, test_acc: 33.2540
Epoch: [ 2/50], cls_loss: 1.1476, transfer_loss: 0.6969, prototype_loss: 0.4402, attention_loss: 0.0048, total_Loss: 2.2896, test_loss 9.545737, test_acc: 34.5628
Epoch: [ 3/50], cls_loss: 0.9938, transfer_loss: 1.2446, prototype_loss: 0.4504, attention_loss: 0.0044, total_Loss: 2.6932, test_loss 5.765398, test_acc: 41.5229
Epoch: [ 4/50], cls_loss: 0.8860, transfer_loss: 1.3073, prototype_loss: 0.4466, attention_loss: 0.0036, total_Loss: 2.6435, test_loss 7.688024, test_acc: 49.8513
Epoch: [ 5/50], cls_loss: 0.8102, transfer_loss: 1.3142, prototype_loss: 0.4531, attention_loss: 0.0030, total_Loss: 2.5805, test_loss 6.086396, test_acc: 28.2570
Epoch: [ 6/50], cls_loss: 0.7653, transfer_loss: 1.2970, prototype_loss: 0.4627, attention_loss: 0.0029, total_Loss: 2.5279, test_loss 9.474872, test_acc: 44.3189
Epoch: [ 7/50], cls_loss: 0.6881, transfer_loss: 1.3485, prototype_loss: 0.4513, attention_loss: 0.0028, total_Loss: 2.4907, test_loss 6.316167, test_acc: 36.9720
Epoch: [ 8/50], cls_loss: 0.6221, transfer_loss: 1.3705, prototype_loss: 0.4454, attention_loss: 0.0030, total_Loss: 2.4409, test_loss 8.289448, test_acc: 43.2183
Epoch: [ 9/50], cls_loss: 0.5838, transfer_loss: 1.3783, prototype_loss: 0.4453, attention_loss: 0.0026, total_Loss: 2.4100, test_loss 10.822335, test_acc: 39.5003
Epoch: [10/50], cls_loss: 0.5447, transfer_loss: 1.3743, prototype_loss: 0.4534, attention_loss: 0.0021, total_Loss: 2.3745, test_loss 8.483333, test_acc: 45.5384
Epoch: [11/50], cls_loss: 0.5282, transfer_loss: 1.3473, prototype_loss: 0.4615, attention_loss: 0.0023, total_Loss: 2.3393, test_loss 5.140481, test_acc: 52.6472
Epoch: [12/50], cls_loss: 0.4837, transfer_loss: 1.3869, prototype_loss: 0.4490, attention_loss: 0.0027, total_Loss: 2.3223, test_loss 7.899492, test_acc: 39.3813
Epoch: [13/50], cls_loss: 0.4424, transfer_loss: 1.3818, prototype_loss: 0.4539, attention_loss: 0.0021, total_Loss: 2.2802, test_loss 3.069586, test_acc: 58.8340
Epoch: [14/50], cls_loss: 0.4183, transfer_loss: 1.3909, prototype_loss: 0.4529, attention_loss: 0.0019, total_Loss: 2.2640, test_loss 6.191159, test_acc: 57.0196
Epoch: [15/50], cls_loss: 0.3992, transfer_loss: 1.3883, prototype_loss: 0.4477, attention_loss: 0.0018, total_Loss: 2.2370, test_loss 4.074046, test_acc: 59.0125
Epoch: [16/50], cls_loss: 0.3539, transfer_loss: 1.3826, prototype_loss: 0.4478, attention_loss: 0.0016, total_Loss: 2.1859, test_loss 9.274577, test_acc: 58.5663
Epoch: [17/50], cls_loss: 0.3439, transfer_loss: 1.3995, prototype_loss: 0.4547, attention_loss: 0.0017, total_Loss: 2.1997, test_loss 5.305997, test_acc: 57.3766
Epoch: [18/50], cls_loss: 0.3205, transfer_loss: 1.3919, prototype_loss: 0.4540, attention_loss: 0.0017, total_Loss: 2.1681, test_loss 9.941660, test_acc: 58.9827
Epoch: [19/50], cls_loss: 0.3073, transfer_loss: 1.3923, prototype_loss: 0.4574, attention_loss: 0.0016, total_Loss: 2.1587, test_loss 12.426505, test_acc: 53.4503
Epoch: [20/50], cls_loss: 0.2964, transfer_loss: 1.3775, prototype_loss: 0.4515, attention_loss: 0.0017, total_Loss: 2.1271, test_loss 8.055415, test_acc: 56.7519
Epoch: [21/50], cls_loss: 0.2875, transfer_loss: 1.3902, prototype_loss: 0.4562, attention_loss: 0.0018, total_Loss: 2.1357, test_loss 9.961908, test_acc: 54.5211
Epoch: [22/50], cls_loss: 0.2614, transfer_loss: 1.3894, prototype_loss: 0.4609, attention_loss: 0.0016, total_Loss: 2.1133, test_loss 11.778889, test_acc: 54.2832
Epoch: [23/50], cls_loss: 0.2569, transfer_loss: 1.3866, prototype_loss: 0.4680, attention_loss: 0.0014, total_Loss: 2.1129, test_loss 9.962620, test_acc: 56.0083
Epoch: [24/50], cls_loss: 0.2300, transfer_loss: 1.3775, prototype_loss: 0.4740, attention_loss: 0.0014, total_Loss: 2.0830, test_loss 7.108223, test_acc: 60.3807
Epoch: [25/50], cls_loss: 0.2329, transfer_loss: 1.3830, prototype_loss: 0.4774, attention_loss: 0.0014, total_Loss: 2.0947, test_loss 9.315754, test_acc: 61.2433
Epoch: [26/50], cls_loss: 0.2195, transfer_loss: 1.3849, prototype_loss: 0.4780, attention_loss: 0.0014, total_Loss: 2.0838, test_loss 11.706330, test_acc: 53.2421
Epoch: [27/50], cls_loss: 0.2143, transfer_loss: 1.3868, prototype_loss: 0.4833, attention_loss: 0.0013, total_Loss: 2.0857, test_loss 10.220900, test_acc: 55.5919
Epoch: [28/50], cls_loss: 0.1854, transfer_loss: 1.3869, prototype_loss: 0.4886, attention_loss: 0.0012, total_Loss: 2.0621, test_loss 7.545972, test_acc: 59.8751
Epoch: [29/50], cls_loss: 0.1960, transfer_loss: 1.3808, prototype_loss: 0.4975, attention_loss: 0.0016, total_Loss: 2.0759, test_loss 10.300201, test_acc: 56.6627
Epoch: [30/50], cls_loss: 0.1781, transfer_loss: 1.3818, prototype_loss: 0.4923, attention_loss: 0.0014, total_Loss: 2.0536, test_loss 9.123877, test_acc: 60.4997
Epoch: [31/50], cls_loss: 0.1609, transfer_loss: 1.3865, prototype_loss: 0.4952, attention_loss: 0.0012, total_Loss: 2.0438, test_loss 9.523724, test_acc: 58.1499
Epoch: [32/50], cls_loss: 0.1622, transfer_loss: 1.3824, prototype_loss: 0.4982, attention_loss: 0.0013, total_Loss: 2.0441, test_loss 10.886095, test_acc: 59.2207
Epoch: [33/50], cls_loss: 0.1551, transfer_loss: 1.3926, prototype_loss: 0.5031, attention_loss: 0.0012, total_Loss: 2.0520, test_loss 11.869687, test_acc: 59.4884
Epoch: [34/50], cls_loss: 0.1553, transfer_loss: 1.3867, prototype_loss: 0.5029, attention_loss: 0.0011, total_Loss: 2.0460, test_loss 13.898429, test_acc: 56.6330
Epoch: [35/50], cls_loss: 0.1474, transfer_loss: 1.3871, prototype_loss: 0.5086, attention_loss: 0.0012, total_Loss: 2.0442, test_loss 11.160296, test_acc: 57.8227
Epoch: [36/50], cls_loss: 0.1343, transfer_loss: 1.3888, prototype_loss: 0.5103, attention_loss: 0.0012, total_Loss: 2.0346, test_loss 12.438384, test_acc: 51.5467
Epoch: [37/50], cls_loss: 0.1329, transfer_loss: 1.3890, prototype_loss: 0.5144, attention_loss: 0.0011, total_Loss: 2.0375, test_loss 11.752261, test_acc: 59.5479
Epoch: [38/50], cls_loss: 0.1178, transfer_loss: 1.3849, prototype_loss: 0.5176, attention_loss: 0.0011, total_Loss: 2.0214, test_loss 8.772068, test_acc: 63.1469
Epoch: [39/50], cls_loss: 0.1277, transfer_loss: 1.3845, prototype_loss: 0.5212, attention_loss: 0.0012, total_Loss: 2.0346, test_loss 11.151437, test_acc: 62.2546
Epoch: [40/50], cls_loss: 0.1238, transfer_loss: 1.3854, prototype_loss: 0.5241, attention_loss: 0.0013, total_Loss: 2.0346, test_loss 15.575503, test_acc: 57.4063
Epoch: [41/50], cls_loss: 0.1135, transfer_loss: 1.3880, prototype_loss: 0.5325, attention_loss: 0.0012, total_Loss: 2.0352, test_loss 15.881386, test_acc: 57.0494
Epoch: [42/50], cls_loss: 0.1105, transfer_loss: 1.3889, prototype_loss: 0.5359, attention_loss: 0.0013, total_Loss: 2.0366, test_loss 6.268081, test_acc: 64.2772
Epoch: [43/50], cls_loss: 0.1178, transfer_loss: 1.3857, prototype_loss: 0.5334, attention_loss: 0.0011, total_Loss: 2.0381, test_loss 12.385919, test_acc: 61.3920
Epoch: [44/50], cls_loss: 0.0974, transfer_loss: 1.3864, prototype_loss: 0.5362, attention_loss: 0.0011, total_Loss: 2.0212, test_loss 15.005831, test_acc: 57.7037
Epoch: [45/50], cls_loss: 0.0995, transfer_loss: 1.3845, prototype_loss: 0.5400, attention_loss: 0.0010, total_Loss: 2.0250, test_loss 11.973612, test_acc: 63.5931
Epoch: [46/50], cls_loss: 0.0931, transfer_loss: 1.3868, prototype_loss: 0.5417, attention_loss: 0.0010, total_Loss: 2.0226, test_loss 12.864625, test_acc: 58.5068
Epoch: [47/50], cls_loss: 0.0946, transfer_loss: 1.3875, prototype_loss: 0.5435, attention_loss: 0.0010, total_Loss: 2.0267, test_loss 15.355846, test_acc: 59.5479
Epoch: [48/50], cls_loss: 0.0814, transfer_loss: 1.3871, prototype_loss: 0.5437, attention_loss: 0.0010, total_Loss: 2.0132, test_loss 12.150440, test_acc: 60.2320
Epoch: [49/50], cls_loss: 0.0802, transfer_loss: 1.3893, prototype_loss: 0.5474, attention_loss: 0.0009, total_Loss: 2.0178, test_loss 16.031743, test_acc: 58.0012
Epoch: [50/50], cls_loss: 0.0921, transfer_loss: 1.3869, prototype_loss: 0.5497, attention_loss: 0.0010, total_Loss: 2.0296, test_loss 16.305599, test_acc: 60.1725
Transfer result: 64.2772

Namespace(backbone='swimvit', batch_size=32, beta=0, config='code/DeepDA/DANN/DANN.yaml', data_dir='/DATA/hejinbo/qiyuhan/datasets/', dataset='Oulu', device=device(type='cuda', index=5), early_stop=0, epoch_based_training=False, lr=0.001, lr_decay=0.75, lr_gamma=0.0003, lr_scheduler=True, momentum=0.9, n_epoch=50, n_iter_per_epoch=300, nav_t=1, num_workers=3, s_par=0.5, seed=3, src_domain='visible', tgt_domain='infrared', transfer_loss='adv', transfer_loss_weight=1.0, use_bottleneck=True, weight_decay=0.0005)
Whole train set size: 32917
Validation set size: 3362
Epoch: [ 1/50], cls_loss: 1.4242, transfer_loss: 0.7327, prototype_loss: 0.5282, total_Loss: 4.1737, test_loss 9.030764, test_acc: 39.0839
Epoch: [ 2/50], cls_loss: 1.1215, transfer_loss: 0.1566, prototype_loss: 0.4007, total_Loss: 3.1302, test_loss 6.613024, test_acc: 52.8257
Epoch: [ 3/50], cls_loss: 1.0288, transfer_loss: 0.1498, prototype_loss: 0.3720, total_Loss: 2.9639, test_loss 9.134010, test_acc: 48.4236
Epoch: [ 4/50], cls_loss: 0.9170, transfer_loss: 0.0474, prototype_loss: 0.3511, total_Loss: 2.7320, test_loss 10.797519, test_acc: 47.3825
Epoch: [ 5/50], cls_loss: 0.8484, transfer_loss: 0.1562, prototype_loss: 0.4020, total_Loss: 2.6312, test_loss 8.053380, test_acc: 16.2403
Epoch: [ 6/50], cls_loss: 0.7847, transfer_loss: 0.9825, prototype_loss: 0.4387, total_Loss: 3.5107, test_loss 6.953540, test_acc: 56.7519
Epoch: [ 7/50], cls_loss: 0.7131, transfer_loss: 1.3247, prototype_loss: 0.4156, total_Loss: 3.8081, test_loss 6.610106, test_acc: 52.9447
Epoch: [ 8/50], cls_loss: 0.6939, transfer_loss: 1.3864, prototype_loss: 0.4050, total_Loss: 3.8227, test_loss 7.764294, test_acc: 49.6728
Epoch: [ 9/50], cls_loss: 0.6277, transfer_loss: 1.3429, prototype_loss: 0.3998, total_Loss: 3.6808, test_loss 7.689277, test_acc: 53.0042
Epoch: [10/50], cls_loss: 0.5707, transfer_loss: 1.3635, prototype_loss: 0.3956, total_Loss: 3.6041, test_loss 10.367274, test_acc: 57.2873
Epoch: [11/50], cls_loss: 0.5637, transfer_loss: 1.3779, prototype_loss: 0.3995, total_Loss: 3.6324, test_loss 9.156697, test_acc: 52.5283
Epoch: [12/50], cls_loss: 0.5223, transfer_loss: 1.3765, prototype_loss: 0.3930, total_Loss: 3.5638, test_loss 7.740128, test_acc: 57.1386
Epoch: [13/50], cls_loss: 0.4815, transfer_loss: 1.3807, prototype_loss: 0.3927, total_Loss: 3.5003, test_loss 10.264128, test_acc: 56.0678
Epoch: [14/50], cls_loss: 0.4449, transfer_loss: 1.4123, prototype_loss: 0.3931, total_Loss: 3.4742, test_loss 14.861628, test_acc: 45.7466
Epoch: [15/50], cls_loss: 0.4346, transfer_loss: 1.3961, prototype_loss: 0.4000, total_Loss: 3.4420, test_loss 6.820525, test_acc: 62.3736
Epoch: [16/50], cls_loss: 0.4083, transfer_loss: 1.3863, prototype_loss: 0.4018, total_Loss: 3.3913, test_loss 8.053174, test_acc: 61.6002
Epoch: [17/50], cls_loss: 0.3810, transfer_loss: 1.3905, prototype_loss: 0.4015, total_Loss: 3.3493, test_loss 7.924110, test_acc: 62.8197
Epoch: [18/50], cls_loss: 0.3463, transfer_loss: 1.3969, prototype_loss: 0.4016, total_Loss: 3.3076, test_loss 6.001771, test_acc: 62.0464
Epoch: [19/50], cls_loss: 0.3414, transfer_loss: 1.3890, prototype_loss: 0.4078, total_Loss: 3.2941, test_loss 8.162027, test_acc: 58.6556
Epoch: [20/50], cls_loss: 0.3194, transfer_loss: 1.3978, prototype_loss: 0.4145, total_Loss: 3.2730, test_loss 7.123955, test_acc: 63.2659
Epoch: [21/50], cls_loss: 0.3131, transfer_loss: 1.4323, prototype_loss: 0.4170, total_Loss: 3.2839, test_loss 7.284425, test_acc: 61.0648
Epoch: [22/50], cls_loss: 0.2903, transfer_loss: 1.3895, prototype_loss: 0.4168, total_Loss: 3.2263, test_loss 8.935776, test_acc: 61.0054
Epoch: [23/50], cls_loss: 0.2873, transfer_loss: 1.3760, prototype_loss: 0.4198, total_Loss: 3.2101, test_loss 8.666132, test_acc: 62.1951
Epoch: [24/50], cls_loss: 0.2590, transfer_loss: 1.3873, prototype_loss: 0.4196, total_Loss: 3.1840, test_loss 6.548410, test_acc: 65.1101
Epoch: [25/50], cls_loss: 0.2513, transfer_loss: 1.3952, prototype_loss: 0.4216, total_Loss: 3.1459, test_loss 4.723133, test_acc: 63.8013
Epoch: [26/50], cls_loss: 0.2404, transfer_loss: 1.3852, prototype_loss: 0.4275, total_Loss: 3.1471, test_loss 5.528941, test_acc: 63.7418
Epoch: [27/50], cls_loss: 0.2172, transfer_loss: 1.3915, prototype_loss: 0.4281, total_Loss: 3.1135, test_loss 9.364335, test_acc: 60.3212
Epoch: [28/50], cls_loss: 0.2107, transfer_loss: 1.3842, prototype_loss: 0.4313, total_Loss: 3.0933, test_loss 7.943985, test_acc: 62.1059
Epoch: [29/50], cls_loss: 0.2147, transfer_loss: 1.3980, prototype_loss: 0.4326, total_Loss: 3.1165, test_loss 8.017696, test_acc: 61.0648
Epoch: [30/50], cls_loss: 0.1914, transfer_loss: 1.3880, prototype_loss: 0.4332, total_Loss: 3.0791, test_loss 8.506381, test_acc: 56.9601
Epoch: [31/50], cls_loss: 0.1784, transfer_loss: 1.3977, prototype_loss: 0.4320, total_Loss: 3.0532, test_loss 9.582988, test_acc: 62.4033
Epoch: [32/50], cls_loss: 0.1805, transfer_loss: 1.3908, prototype_loss: 0.4330, total_Loss: 3.0589, test_loss 7.725167, test_acc: 61.4515
Epoch: [33/50], cls_loss: 0.1824, transfer_loss: 1.3833, prototype_loss: 0.4511, total_Loss: 3.0536, test_loss 9.000866, test_acc: 66.2106
Epoch: [34/50], cls_loss: 0.1578, transfer_loss: 1.3927, prototype_loss: 0.4444, total_Loss: 3.0180, test_loss 8.473524, test_acc: 62.5223
Epoch: [35/50], cls_loss: 0.1679, transfer_loss: 1.3915, prototype_loss: 0.4451, total_Loss: 3.0157, test_loss 8.980909, test_acc: 64.4259
Epoch: [36/50], cls_loss: 0.1462, transfer_loss: 1.3956, prototype_loss: 0.4469, total_Loss: 2.9713, test_loss 6.856517, test_acc: 62.1059
Epoch: [37/50], cls_loss: 0.1447, transfer_loss: 1.3903, prototype_loss: 0.4459, total_Loss: 2.9977, test_loss 8.771290, test_acc: 59.7264
Epoch: [38/50], cls_loss: 0.1329, transfer_loss: 1.3932, prototype_loss: 0.4516, total_Loss: 2.9762, test_loss 10.524477, test_acc: 61.8679
Epoch: [39/50], cls_loss: 0.1446, transfer_loss: 1.3927, prototype_loss: 0.4533, total_Loss: 3.0068, test_loss 7.697027, test_acc: 64.2772
Epoch: [40/50], cls_loss: 0.1219, transfer_loss: 1.3905, prototype_loss: 0.4547, total_Loss: 2.9542, test_loss 7.174760, test_acc: 65.7049
Epoch: [41/50], cls_loss: 0.1294, transfer_loss: 1.3839, prototype_loss: 0.4566, total_Loss: 2.9756, test_loss 9.452317, test_acc: 62.7900
Epoch: [42/50], cls_loss: 0.1152, transfer_loss: 1.3899, prototype_loss: 0.4596, total_Loss: 2.9298, test_loss 11.539403, test_acc: 60.3510
Epoch: [43/50], cls_loss: 0.1134, transfer_loss: 1.3833, prototype_loss: 0.4577, total_Loss: 2.9243, test_loss 10.533385, test_acc: 63.1469
Epoch: [44/50], cls_loss: 0.1147, transfer_loss: 1.3871, prototype_loss: 0.4596, total_Loss: 2.9350, test_loss 10.836938, test_acc: 61.4813
Epoch: [45/50], cls_loss: 0.1097, transfer_loss: 1.3876, prototype_loss: 0.4619, total_Loss: 2.9458, test_loss 10.724047, test_acc: 63.2362
Epoch: [46/50], cls_loss: 0.1051, transfer_loss: 1.3921, prototype_loss: 0.4643, total_Loss: 2.9247, test_loss 10.881139, test_acc: 59.1017
Epoch: [47/50], cls_loss: 0.0999, transfer_loss: 1.3924, prototype_loss: 0.4646, total_Loss: 2.9322, test_loss 10.826243, test_acc: 60.7079
Epoch: [48/50], cls_loss: 0.0957, transfer_loss: 1.3850, prototype_loss: 0.4658, total_Loss: 2.9106, test_loss 9.879108, test_acc: 64.4557
Epoch: [49/50], cls_loss: 0.0960, transfer_loss: 1.3891, prototype_loss: 0.4691, total_Loss: 2.9293, test_loss 11.142039, test_acc: 60.7079
Epoch: [50/50], cls_loss: 0.0902, transfer_loss: 1.3814, prototype_loss: 0.4682, total_Loss: 2.8984, test_loss 6.552190, test_acc: 65.5860
Transfer result: 66.2106